---
title: "Fix: LLM Request Rejected - Unexpected tool_use_id in tool_result Blocks"
description: "How to resolve the 'unexpected tool_use_id found in tool_result blocks' error in OpenClaw by clearing corrupted session files"
slug: /troubleshooting/fix-tool-use-id-error
tags: troubleshooting, error, session, fix
publishedAt: 2026-02-01
status: published
visibility: public
isPinned: false
featuredImageUrl: /images/features/fix_tool_use_id_head.webp
---

# Fix: LLM Request Rejected â€” Unexpected tool_use_id in tool_result Blocks

If you're using OpenClaw and suddenly hit this error:

```
LLM request rejected: messages.58.content.1: unexpected tool_use_id found
in tool_result blocks: toolu_01BuEWGgvuHAY9iAXdbCpCEw.
Each tool_result block must have a corresponding tool_use block in the
previous message.
```

Don't panic. This is a **corrupted session file** issue, and it's easy to fix.

## What Causes This Error?

When OpenClaw communicates with an LLM (like Claude), it sends the conversation history as a series of messages. Each `tool_result` block must reference a `tool_use` block from the previous message â€” they work in pairs.

This error occurs when the session history gets out of sync:

- A **session compaction** removed the `tool_use` block but left the `tool_result`
- The process was **interrupted mid-conversation** (crash, force quit, network timeout)
- A **manual edit** to session files broke the message chain

The LLM API validates the message structure strictly. If it finds a `tool_result` referencing a `tool_use_id` that doesn't exist in the previous message, it rejects the entire request.

## The Fix: Delete the Corrupted Session File

### Step 1: Find Your Session Directory

OpenClaw stores session transcripts as `.jsonl` files. The location depends on your setup:

```bash
# Default location on macOS/Linux
~/.openclaw/agents/main/sessions/

# Check your workspace
ls -lt ~/.openclaw/agents/main/sessions/*.jsonl | head -5
```

### Step 2: Identify the Corrupted File

The most recently modified `.jsonl` file is likely the culprit:

```bash
# List sessions sorted by modification time (newest first)
ls -lt ~/.openclaw/agents/main/sessions/*.jsonl | head -5
```

You'll see something like:

```
-rw-r--r--  1 user  staff  245632 Feb  1 12:30 abc123-def456.jsonl
-rw-r--r--  1 user  staff  189421 Feb  1 10:15 789ghi-012jkl.jsonl
```

### Step 3: Delete the Corrupted Session

```bash
# Remove the most recent session file
rm ~/.openclaw/agents/main/sessions/<corrupted-file>.jsonl
```

Or if you prefer a safer approach:

```bash
# Move it instead of deleting
mv ~/.openclaw/agents/main/sessions/<corrupted-file>.jsonl /tmp/
```

### Step 4: Restart the Gateway

```bash
openclaw gateway restart
```

That's it. OpenClaw will start a fresh session and the error should be gone.

## Prevention Tips

1. **Don't force-quit OpenClaw** during active tool execution â€” let it finish or use the `/abort` command
2. **Avoid editing `.jsonl` files manually** â€” these are machine-generated transcripts
3. **Regular gateway restarts** can help clear stale session state
4. If you see frequent compaction issues, consider adjusting your `compaction` settings in the gateway config

## Understanding the Error Message

Let's break down the error:

| Part | Meaning |
|------|---------|
| `messages.58.content.1` | The 59th message (0-indexed), 2nd content block |
| `unexpected tool_use_id` | Found a tool_result referencing a non-existent tool_use |
| `toolu_01BuEWGgvuHAY9iAXdbCpCEw` | The specific tool call ID that's orphaned |
| `Each tool_result block must have a corresponding tool_use block` | The API's validation rule |

## Related Issues

- **"All models failed"** â€” Could be a different issue. Check your API keys and model configuration.
- **"Session too large"** â€” Your session history might be too long. OpenClaw handles this with automatic compaction.
- **Gateway won't start** â€” Try `openclaw doctor` to diagnose issues.

## Summary

| Problem | Corrupted session file with orphaned tool_result blocks |
|---------|--------------------------------------------------------|
| Cause | Session compaction, crash, or interruption during tool execution |
| Fix | Delete the most recent `.jsonl` file in the sessions directory |
| Time to fix | 30 seconds |
| Prevention | Don't force-quit during tool execution |

This is one of those errors that looks scary but has a simple fix. If you encounter it, just clear the session and move on. Happy automating! ðŸš€
