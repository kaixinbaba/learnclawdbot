---
title: "Переменные окружения OpenClaw: Полный справочник по настройке"
description: "Освойте переменные окружения OpenClaw для настройки Gateway, аутентификации моделей и развёртывания. Охватывает OPENCLAW_GATEWAY_TOKEN, API-ключи, настройки привязки и конфигурации для разных платформ."
slug: /openclaw-environment-variables
publishedAt: 2026-02-17
status: published
visibility: public
featuredImageUrl: /images/features/env-vars-guide.webp
---

# Переменные окружения OpenClaw: Полный справочник по настройке

Переменные окружения — это основа развёртывания OpenClaw. Независимо от того, работаете ли вы локально, на VPS или в Docker, понимание этих переменных критически важно для безопасности, подключения и правильной аутентификации.

Это руководство охватывает все переменные окружения с реальными примерами и советами по устранению неполадок.

## Краткий справочник

| Переменная | Обязательна | Назначение |
|------------|-------------|------------|
| `OPENCLAW_GATEWAY_TOKEN` | Для удалённого | Токен аутентификации Gateway |
| `OPENCLAW_GATEWAY_PORT` | Нет | Порт Gateway (по умолчанию: 18789) |
| `OPENCLAW_GATEWAY_BIND` | Нет | Сетевая привязка (lan/tailnet) |
| `ANTHROPIC_API_KEY` | Да* | Доступ к моделям Anthropic |
| `OPENAI_API_KEY` | Да* | Доступ к моделям OpenAI |
| `BRAVE_API_KEY` | Нет | Функция веб-поиска |
| `GEMINI_API_KEY` | Нет | Модели Google Gemini |

*Требуется минимум один API-ключ модели.

## Переменные Gateway

### OPENCLAW_GATEWAY_TOKEN

Самая важная переменная безопасности. Требуется, когда Gateway привязывается к не-loopback адресам.

```bash
# Генерация безопасного токена
export OPENCLAW_GATEWAY_TOKEN=$(openssl rand -hex 32)
```

**Когда нужна:**
- Развёртывание в Docker
- VPS/облачный хостинг
- Любой доступ не через localhost

**Примечания по безопасности:**
- Рассматривайте как административный секрет
- Никогда не коммитьте в систему контроля версий
- Периодически меняйте в продакшене

### OPENCLAW_GATEWAY_PORT

Переопределяет порт Gateway по умолчанию (18789).

```bash
export OPENCLAW_GATEWAY_PORT=3000
```

**Типичные сценарии:**
- Конфликты портов с другими сервисами
- Требования платформы (например, health checks Fly.io)
- Настройки обратного прокси

### OPENCLAW_GATEWAY_BIND

Управляет сетевыми интерфейсами, на которых слушает Gateway.

```bash
# Слушать на всех LAN интерфейсах
export OPENCLAW_GATEWAY_BIND=lan

# Слушать только на интерфейсе Tailscale
export OPENCLAW_GATEWAY_BIND=tailnet
```

**Варианты:**
- `localhost` (по умолчанию) — только loopback
- `lan` — все сетевые интерфейсы
- `tailnet` — только интерфейс Tailscale

**Предупреждение безопасности:** Использование `lan` без `OPENCLAW_GATEWAY_TOKEN` опасно!

## API-ключи моделей

### ANTHROPIC_API_KEY

Основной ключ для моделей Claude.

```bash
export ANTHROPIC_API_KEY="sk-ant-api03-..."
```

**Способы настройки:**
1. Экспорт в shell
2. Добавление в `~/.openclaw/.env`
3. Использование мастера `openclaw onboard`

**Проверка:**

```bash
openclaw models status
openclaw doctor
```

### OPENAI_API_KEY

Для моделей OpenAI (GPT-4 и др.).

```bash
export OPENAI_API_KEY="sk-..."
```

### GEMINI_API_KEY

Для моделей Google Gemini и генерации изображений.

```bash
export GEMINI_API_KEY="AIza..."
```

## Переменные для инструментов

### BRAVE_API_KEY

Включает функцию веб-поиска.

```bash
export BRAVE_API_KEY="BSA..."
```

**Примечание:** Используйте план "Data for Search", а не "Data for AI".

## Конфигурации для платформ

### Docker / Docker Compose

Создайте файл `.env`:

```bash
OPENCLAW_GATEWAY_TOKEN=your-secure-token
OPENCLAW_GATEWAY_BIND=lan
OPENCLAW_GATEWAY_PORT=18789
ANTHROPIC_API_KEY=sk-ant-...
```

Ссылка в `docker-compose.yml`:

```yaml
services:
  openclaw:
    image: openclaw/gateway
    env_file:
      - .env
    ports:
      - "18789:18789"
```

### Fly.io

Установка секретов через CLI:

```bash
fly secrets set OPENCLAW_GATEWAY_TOKEN=$(openssl rand -hex 32)
fly secrets set ANTHROPIC_API_KEY=sk-ant-...
```

**Важно:** Сопоставьте `internal_port` с `OPENCLAW_GATEWAY_PORT`:

```toml
[[services]]
  internal_port = 3000
```

```bash
fly secrets set OPENCLAW_GATEWAY_PORT=3000
```

### Hetzner / GCP / Обычный VPS

Создайте `~/.openclaw/.env` на сервере:

```bash
OPENCLAW_GATEWAY_TOKEN=change-me-now
OPENCLAW_GATEWAY_BIND=lan
OPENCLAW_GATEWAY_PORT=18789
ANTHROPIC_API_KEY=sk-ant-...
```

Затем перезапустите Gateway:

```bash
openclaw gateway restart
```

### systemd / launchd

Для персистентности демона поместите ключи в `~/.openclaw/.env`:

```bash
cat >> ~/.openclaw/.env << 'EOF'
ANTHROPIC_API_KEY=sk-ant-...
BRAVE_API_KEY=BSA...
EOF
```

Gateway автоматически читает этот файл при запуске.

## Файл ~/.openclaw/.env

Рекомендуемое место для постоянных переменных окружения:

```bash
# ~/.openclaw/.env
ANTHROPIC_API_KEY=sk-ant-api03-xxx
OPENAI_API_KEY=sk-xxx
BRAVE_API_KEY=BSA-xxx
OPENCLAW_GATEWAY_TOKEN=your-secure-token
```

**Почему использовать этот файл:**
- Сохраняется после перезапуска shell
- Работает с демонами systemd/launchd
- Защищает секреты от истории shell
- Единый источник истины

## Продвинутые переменные

### Конфигурация инструмента Exec

```bash
# Тайм-аут фона по умолчанию (мс)
PI_BASH_YIELD_MS=10000

# Максимальный буфер вывода (символов)
PI_BASH_MAX_OUTPUT_CHARS=100000

# TTL завершённых сессий (мс, 1мин-3ч)
PI_BASH_JOB_TTL_MS=1800000
```

### Canvas Host

```bash
# Отключить canvas host
OPENCLAW_SKIP_CANVAS_HOST=1
```

## Устранение неполадок

### "No credentials found"

**Причина:** API-ключ не установлен или недоступен для Gateway.

**Решение:**
1. Проверьте экспорт переменной: `echo $ANTHROPIC_API_KEY`
2. При использовании демона добавьте в `~/.openclaw/.env`
3. Перезапустите Gateway: `openclaw gateway restart`
4. Проверьте: `openclaw models status`

### "Connection refused" на удалённом Gateway

**Причина:** Gateway привязан только к localhost.

**Решение:**
```bash
export OPENCLAW_GATEWAY_BIND=lan
export OPENCLAW_GATEWAY_TOKEN=$(openssl rand -hex 32)
openclaw gateway restart
```

### Ошибка "Unauthorized"

**Причина:** Несоответствие токена между клиентом и Gateway.

**Решение:**
1. Проверьте токен на хосте Gateway: `echo $OPENCLAW_GATEWAY_TOKEN`
2. Используйте тот же токен при подключении с клиента
3. Убедитесь в отсутствии пробелов или кавычек

### Порт уже используется

**Причина:** Другой процесс использует порт 18789.

**Решение:**
```bash
# Найти процесс
lsof -i :18789

# Использовать другой порт
export OPENCLAW_GATEWAY_PORT=3001
openclaw gateway restart
```

## Лучшие практики

1. **Никогда не коммитьте секреты** — Используйте `.env` и добавьте в `.gitignore`
2. **Используйте безопасную генерацию токенов** — `openssl rand -hex 32` или аналог
3. **Предпочитайте `~/.openclaw/.env`** — Работает при перезапусках и с демонами
4. **Периодически меняйте токены** — Особенно в продакшене
5. **Используйте `openclaw doctor`** — Выявляет проблемы конфигурации рано
6. **Привязывайтесь к tailnet когда возможно** — Безопаснее чем `lan`

## Приоритет переменных окружения

OpenClaw читает переменные в следующем порядке (позднее перезаписывает раннее):

1. Системное окружение
2. Файл `~/.openclaw/.env`
3. Файл конфигурации (`~/.openclaw/openclaw.json`)

## Итоги

Переменные окружения контролируют безопасность, подключение и доступ к моделям OpenClaw:

| Категория | Ключевые переменные |
|-----------|---------------------|
| **Безопасность** | `OPENCLAW_GATEWAY_TOKEN` |
| **Сеть** | `OPENCLAW_GATEWAY_BIND`, `OPENCLAW_GATEWAY_PORT` |
| **Модели** | `ANTHROPIC_API_KEY`, `OPENAI_API_KEY`, `GEMINI_API_KEY` |
| **Инструменты** | `BRAVE_API_KEY` |

Настройте их правильно, и ваше развёртывание OpenClaw будет безопасным и функциональным.

## Связанные ресурсы

- [Конфигурация Gateway](/docs/gateway) — Полное руководство по настройке Gateway
- [Развёртывание Docker](/docs/docker) — Контейнеризированное развёртывание
- [Настройка VPS](/docs/vps) — Развёртывание на облачном сервере
- [Аутентификация](/docs/authentication) — Глубокое погружение в аутентификацию моделей
