---
title: Руководство по настройке мульти-агентов OpenClaw - Запуск нескольких AI-ассистентов
description: Узнайте, как настроить несколько изолированных AI-агентов в OpenClaw с отдельными рабочими пространствами, личностями и привязками каналов для WhatsApp, Telegram и Discord
slug: /multi-agent-setup
tags: мульти-агент, конфигурация, маршрутизация, привязки, продвинутый
publishedAt: 2026-02-14
status: published
visibility: public
featuredImageUrl: /images/features/multi-agent-setup.webp
---

# Руководство по настройке мульти-агентов OpenClaw

Запуск нескольких AI-ассистентов из одного шлюза OpenClaw — одна из самых мощных доступных функций. Это руководство проведёт вас через настройку изолированных агентов с собственными личностями, рабочими пространствами и привязками каналов.

## Что такое мульти-агент?

В OpenClaw **агент** — это полностью изолированный AI-мозг со своим:

- **Рабочее пространство** — Файлы, AGENTS.md, SOUL.md, USER.md, правила личности
- **Каталог состояния** — Профили аутентификации, реестр моделей, конфигурация агента
- **Хранилище сессий** — История чатов и состояние маршрутизации
- **Навыки** — Навыки агента в папке `skills/` рабочего пространства

Это означает, что вы можете запускать полностью отдельных AI-ассистентов на одном сервере — разные личности, разные возможности, разные уровни доступа.

## Типичные случаи использования

- **Личное vs Работа** — Направляйте рабочие сообщения профессиональному агенту, личные — повседневному
- **Семейный бот** — Ограниченный агент для семейных групповых чатов с ограниченными инструментами
- **Многопользовательский сервер** — Каждый член семьи получает собственного изолированного ассистента
- **Разные модели** — Быстрый Sonnet для повседневных задач, мощный Opus для глубокой работы

## Быстрый старт: Добавление агента

Самый простой способ добавить нового агента — использовать мастер:

```bash
openclaw agents add work
```

Это создаёт:
- Рабочее пространство: `~/.openclaw/workspace-work`
- Каталог агента: `~/.openclaw/agents/work/agent`
- Хранилище сессий: `~/.openclaw/agents/work/sessions`

Проверьте ваших агентов:

```bash
openclaw agents list --bindings
```

## Понимание привязок

**Привязки** направляют входящие сообщения нужному агенту. Они сопоставляются по:

1. `peer` — Конкретный DM или ID группы (наиболее конкретный, побеждает первым)
2. `guildId` — Сервер Discord
3. `teamId` — Рабочее пространство Slack
4. `accountId` — Аккаунт канала (например, какой номер WhatsApp)
5. `channel` — Весь канал (наименее конкретный)

**Правило: Наиболее конкретное совпадение побеждает.** Размещайте привязки peer выше правил для всего канала.

## Примеры конфигурации

### Пример 1: Два номера WhatsApp → Два агента

Направляйте разные аккаунты WhatsApp разным агентам:

```json
{
  "agents": {
    "list": [
      {
        "id": "home",
        "default": true,
        "name": "Home",
        "workspace": "~/.openclaw/workspace-home",
        "agentDir": "~/.openclaw/agents/home/agent"
      },
      {
        "id": "work",
        "name": "Work",
        "workspace": "~/.openclaw/workspace-work",
        "agentDir": "~/.openclaw/agents/work/agent"
      }
    ]
  },
  "bindings": [
    { "agentId": "home", "match": { "channel": "whatsapp", "accountId": "personal" } },
    { "agentId": "work", "match": { "channel": "whatsapp", "accountId": "biz" } }
  ],
  "channels": {
    "whatsapp": {
      "accounts": {
        "personal": {},
        "biz": {}
      }
    }
  }
}
```

### Пример 2: WhatsApp для повседневного + Telegram для глубокой работы

Направляйте разные каналы на разные уровни моделей:

```json
{
  "agents": {
    "list": [
      {
        "id": "chat",
        "name": "Everyday",
        "workspace": "~/.openclaw/workspace-chat",
        "model": "anthropic/claude-sonnet-4-5"
      },
      {
        "id": "opus",
        "name": "Deep Work",
        "workspace": "~/.openclaw/workspace-opus",
        "model": "anthropic/claude-opus-4-5"
      }
    ]
  },
  "bindings": [
    { "agentId": "chat", "match": { "channel": "whatsapp" } },
    { "agentId": "opus", "match": { "channel": "telegram" } }
  ]
}
```

### Пример 3: Один WhatsApp, несколько пользователей

Направляйте разные DM разным агентам, используя один номер WhatsApp:

```json
{
  "agents": {
    "list": [
      { "id": "alex", "workspace": "~/.openclaw/workspace-alex" },
      { "id": "mia", "workspace": "~/.openclaw/workspace-mia" }
    ]
  },
  "bindings": [
    { "agentId": "alex", "match": { "channel": "whatsapp", "peer": { "kind": "dm", "id": "+15551230001" } } },
    { "agentId": "mia", "match": { "channel": "whatsapp", "peer": { "kind": "dm", "id": "+15551230002" } } }
  ],
  "channels": {
    "whatsapp": {
      "dmPolicy": "allowlist",
      "allowFrom": ["+15551230001", "+15551230002"]
    }
  }
}
```

## Типичные проблемы и решения

### "Session file path must be within sessions directory"

Это **самая распространённая ошибка мульти-агента**. Причины:

1. **Отсутствует agentId в привязках** — Убедитесь, что каждая привязка имеет правильный `agentId`
2. **Конфликт путей** — Не используйте повторно `agentDir` между агентами
3. **Несоответствие версий** — Обновитесь до последней версии OpenClaw

**Исправление:** Проверьте, что привязки точно соответствуют ID агентов:

```bash
openclaw agents list --bindings
```

### Агент не получает сообщения

1. **Проверьте порядок привязок** — Более конкретные привязки должны быть первыми
2. **Проверьте доступ к каналу** — Убедитесь, что `allowFrom` или `groupPolicy` канала включает отправителя
3. **Проверьте статус агента** — Выполните `openclaw status` для проверки активности всех агентов

### Профили аутентификации не работают

Профили аутентификации **специфичны для агента**. Каждый агент читает из:

```
~/.openclaw/agents/<agentId>/agent/auth-profiles.json
```

Для совместного использования учётных данных скопируйте `auth-profiles.json` в `agentDir` другого агента.

## Лучшие практики

### 1. Используйте мастер

Всегда используйте `openclaw agents add <name>` вместо ручной настройки. Это правильно настраивает каталоги.

### 2. Сначала тестируйте привязки

Перед запуском в продакшен проверьте маршрутизацию:

```bash
openclaw agents list --bindings
```

### 3. Держите рабочие пространства отдельно

Каждый агент должен иметь собственный каталог рабочего пространства. Никогда не делитесь рабочими пространствами между агентами.

### 4. Используйте конкретные привязки

Размещайте наиболее конкретные привязки (совпадения peer) в верхней части списка привязок.

### 5. Изолируйте ненадёжных агентов

Для агентов, взаимодействующих с ненадёжными пользователями, включите режим песочницы и ограничьте инструменты.

## Резюме

Настройка мульти-агентов позволяет запускать несколько изолированных AI-ассистентов из одного шлюза OpenClaw. Ключевые моменты:

- **Используйте мастер** — `openclaw agents add <name>` правильно настраивает всё
- **Привязки маршрутизируют сообщения** — Наиболее конкретное совпадение побеждает
- **Каждый агент изолирован** — Отдельное рабочее пространство, аутентификация, сессии
- **Инструменты/песочница для каждого агента** — Ограничивайте возможности ненадёжных агентов

---

**Совет профессионала:** Начните с двух агентов (личный + рабочий) и расширяйтесь оттуда. Тщательно тестируйте привязки перед добавлением сложности!
