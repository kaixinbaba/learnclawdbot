---
title: "ClawGuard：OpenClaw エージェントの検証可能なガードレール"
description: "ClawGuard が暗号証明を使用して OpenClaw エージェントが信頼できるガードレールの下で実行されていることを検証し、ユーザーとサービスプロバイダーの両方を保護する方法を学びます"
slug: /security/clawguard-verifiable-guardrails
tags: セキュリティ, ガードレール, アテステーション, TEE, ClawGuard
publishedAt: 2026-02-11
status: published
visibility: public
isPinned: false
featuredImageUrl: /images/features/clawguard_head.webp
---

# ClawGuard：OpenClaw エージェントの検証可能なガードレール

OpenClaw の採用が加速する中、重要な疑問が浮上しています：**AI エージェントが主張する安全制約の下で実際に動作していることをどうやって知るのか？**

ClawGuard は、OpenClaw エージェントが特定の実行可能なガードレールの下で動作していることを暗号学的に証明できるオープンソースのプロトタイプです。宣言を信じる代わりに、証拠を直接検証できるようになりました。

## なぜ検証可能なガードレールが重要なのか

今日の AI エージェントは想定された制約の下で動作しています。エージェントはポリシーと保護措置で構成されている可能性がありますが、外部の関係者がレスポンスが生成される際にこれらの保護措置が実際に有効であることを確認する信頼できる方法はありません。

これは両側にリスクをもたらします：

### ユーザーにとって
- エージェントは、ユーザーがその影響を十分に理解していない広範な権限を受け取ることがよくあります
- アクションがユーザーの意図や承認を大きく超える可能性があります
- 個人データの漏洩、意図しないシステムアクセス、金銭的損害は現実的なリスクです

### サービスプロバイダーにとって
- 意味のあるガードレールなしでエージェント駆動の API 呼び出しが増加しています
- 問題が発生すると、ユーザーはエージェントの設定ではなくサービスを非難します
- プロバイダーは、不正使用報告、詐欺調査、評判の損害に直面します

**ClawGuard は、エージェントの安全制約を単に設定可能にするのではなく、検証可能にすることでこれを解決します。**

## ClawGuard とは？

ClawGuard は、OpenClaw エージェントが次のことを証明する暗号証明を生成できるようにするオープンソースの研究プロトタイプです：

1. **既知のガードレールが積極的にポリシーを実施している**
2. **エージェントが信頼できる実行環境（TEE）内で動作している**
3. **レスポンスがこれらの制約の下で生成されている**、単に事後に主張されているのではない

これは特に、ユーザーが AI が人間中心で安全志向のガードレールによって実際に制約されていることを知る必要がある高リスクなやり取りにおいて重要です。

## ClawGuard の仕組み

ClawGuard は **AWS Nitro Enclaves**（ハードウェアベースの TEE）を使用して、検証可能な実行環境を作成します：

```
┌─────────────────────────────────────────────────┐
│  Nitro Enclave (信頼できる実行環境)               │
│                                                 │
│  ┌─────────────────────────────────────────┐   │
│  │  ガードレールプロキシ (localhost:8080)   │   │
│  │  ✓ 入出力検証                            │   │
│  │  ✓ コンテンツ安全チェック                │   │
│  │  ✓ ポリシー実施                          │   │
│  │  ✓ 監査ログ                              │   │
│  └──────────────┬──────────────────────────┘   │
│                 │ すべての LLM 呼び出しが通過     │
│                 ↓                                │
│  ┌─────────────────────────────────────────┐   │
│  │  OpenClaw エージェント                   │   │
│  │  設定: OPENAI_BASE_URL=:8080           │   │
│  └─────────────────────────────────────────┘   │
│                                                 │
│  ┌─────────────────────────────────────────┐   │
│  │  アテステーションサーバー (localhost:8765)│   │
│  │  暗号証明を生成                          │   │
│  └─────────────────────────────────────────┘   │
└─────────────────────────────────────────────────┘
```

### 主要コンポーネント

1. **ガードレールプロキシ**：すべての LLM インタラクションは、ポリシーを実施するガードレール傍受レイヤーを通じてルーティングされます
2. **信頼できる実行環境**：AWS Nitro Enclave は、コードが隔離され改ざん防止された状態で実行されることを保証します
3. **リモートアテステーション**：enclave は外部で検証できるアテステーション（PCR 測定値付き）を生成します
4. **検証可能なエージェント**：OpenClaw エージェントは enclave 内で実行され、ガードレールをバイパスできません

## インストールとセットアップ

### 前提条件

- Nitro Enclave をサポートする AWS EC2 インスタンス（例：m5.xlarge）
- OpenClaw のインストール
- OpenAI API キーまたは互換性のある LLM プロバイダー

### クイックスタート

1. **ClawGuard リポジトリをクローン：**

```bash
git clone https://github.com/SaharaLabsAI/Verifiable-ClawGuard.git
cd Verifiable-ClawGuard
```

2. **enclave イメージをビルド：**

```bash
cd src
./build_and_deploy.sh
```

これにより enclave がビルドされ、その **PCR2 測定値**（ガードレールコードの暗号ハッシュ）が表示されます：

```
"PCR2": "6cb06673b5b9b74edd2dc459914353898c1612ff..."
```

この測定値を保存してください—これは信頼するガードレール設定のフィンガープリントです。

3. **enclave を実行：**

```bash
nitro-cli run-enclave \
  --eif-path guardrail-vsock.eif \
  --memory 5700 \
  --cpu-count 2

# 割り当てられた CID を取得
ENCLAVE_CID=$(nitro-cli describe-enclaves | jq -r '.[0].EnclaveCID')
echo "Enclave running on CID: $ENCLAVE_CID"
```

4. **enclave 内で OpenClaw を起動：**

```bash
./ec2_setup.sh \
  --agent-version 2026.1.24-3 \
  --enclave-cid $ENCLAVE_CID \
  --api-key ${OPENAI_API_KEY}
```

これにより、すべての LLM 呼び出しがガードレールプロキシを通過するように OpenClaw が設定され、アテステーションがスキルとして登録されます。

5. **接続してアテステーションをリクエスト：**

SSH ポートフォワーディングを使用してゲートウェイにアクセス：

```bash
ssh -L 18789:127.0.0.1:18789 your-ec2-instance
```

Web クライアントを開いてエージェントとチャットします。直接アテステーションをリクエスト：

```
"ガードレールの下で動作していることを証明できますか？"
```

## アテステーションの検証

エージェントは暗号証明を含むアテステーション文書で応答します。検証：

```bash
python verify_attestation.py \
  --file attestation_quote.json \
  --pcr2 6cb06673b5b9b74edd2dc459914353898c1612ff...
```

有効なアテステーションは次のことを証明します：

1. **メッセージが本物の AWS Nitro Enclave 内で処理された**（署名が検証された）
2. **信頼する正確なガードレールコードが実行されている**（PCR2 が既知の測定値と一致）

## 主要機能

### 1. ガードレールの暗号証明

設定の主張に依存する従来のエージェントセキュリティとは異なり、ClawGuard はガードレールが実際に実施されているという暗号証拠を提供します。

### 2. ハードウェアベースの信頼

AWS Nitro Enclaves はハードウェアレベルの隔離を提供します。ホストシステムでさえ、enclave 内で実行されているコードを改ざんできません。

### 3. エージェント更新をまたいで安定した PCR

PCR2 測定値は **ガードレールコード**に結び付けられており、OpenClaw バージョンではありません。セキュリティ態勢を変更せずに OpenClaw を更新できます。

### 4. ポリシー実施

すべての LLM インタラクションはガードレールプロキシを通過し、レスポンスが安全チェックをバイパスしないことを保証します。

### 5. 監査証跡

システムはすべての保護されたインタラクションをログに記録し、エージェントの動作の監査可能な記録を作成します。

## 使用例

### ユーザー向け：エージェントの安全性を検証

機密情報を共有したり、高リスクなタスクを委任したりする前に：

```
ユーザー：「財務上の決定についてアドバイスが必要です。
          安全ガードレールの下で動作していることを証明できますか？」

エージェント：[PCR 測定値を含むアテステーションを提供]

ユーザー：[PCR2 が既知の安全なガードレールと一致することを検証]
         "検証しました。これで安心して進めます。"
```

### サービスプロバイダー向け：インフラストラクチャを保護

高影響力のツールや機密データを提供する前にアテステーションを要求：

```python
def serve_sensitive_api(agent_request):
    attestation = agent_request.get_attestation()
    
    if not verify_attestation(attestation, TRUSTED_PCR2):
        return "アクセス拒否：ガードレール検証失敗"
    
    # 安全に提供 - エージェントは証明可能に制約されている
    return process_request(agent_request)
```

### データ所有者向け：使用境界を実施

「分析するが流出させない」などのポリシーを実施：

```
データ所有者：「このデータセットにアクセスできますが、
              データ保護ガードレールの下で動作していることを証明した場合のみです。」

エージェント：[正しいガードレールがアクティブであることを証明するアテステーションを提供]

データ所有者：[検証後にアクセスを許可]
```

## 実例

ClawGuard のインタラクションは次のようになります：

**ユーザーが高リスクな質問をする：**
> "退職貯蓄をスタートアップに投資することを検討しています。すべきでしょうか？"

**ClawGuard なし：** エージェントに安全制約があることを期待しますが、検証できません。

**ClawGuard あり：** アテステーションをリクエスト：
> "ガードレールの検証済み要約を提供できますか？"

**エージェントの応答：**
1. 質問に対する思慮深い答え
2. 次のことを証明するアテステーション文書：
   - レスポンスが TEE 内で生成された
   - 既知の安全ガードレールがアクティブだった
   - 財務アドバイスポリシーが実施された

アドバイスを信頼する前に PCR2 測定値を独立して検証します。

## 制限と今後の作業

ClawGuard は**研究プロトタイプ**であり、完成品ではありません。重要な注意事項：

### 現在の制限

- **ガードレールは完璧ではない**：システムは約束されたガードレールが実行されていることを保証しますが、ガードレールがすべてをキャッチすることは保証できません
- **エンドツーエンド暗号化なし**：このバージョンではユーザーと enclave 間の通信は完全に暗号化されていません
- **デバッグモードの注意**：デバッグモードが有効な場合、PCR2 はすべてゼロです（開発用のみ）

### 今後の作業

- より強力な実行制約（任意のコマンド実行のブロック）
- エンドツーエンド暗号化通信
- 受け入れ可能なエージェントビルドのガードレールホワイトリスト
- Sahara AI の [x402 プロトコル](https://github.com/SaharaLabsAI/x-function)との統合（マイクロペイメントでゲートされたツールアクセス用）

## 関連リソース

- **GitHub リポジトリ**：[SaharaLabsAI/Verifiable-ClawGuard](https://github.com/SaharaLabsAI/Verifiable-ClawGuard)
- **Sahara AI ブログ**：[ClawGuard 発表](https://saharaai.com/zh/blog/openclaw-agent-guardrails)
- **エージェントプロトコル**：[x402 拡張機能を備えた x-function](https://github.com/SaharaLabsAI/x-function/tree/main/verifiable)

## 結論

AI エージェントがより多くの責任を担うにつれて、重要な質問は次のように変わります：

**「このエージェントを信頼しますか？」**

から

**「このエージェントは信頼に値することを証明できますか？」**

ClawGuard は、その証明を可能にするための初期の一歩です。エージェントを完全に安全にすると主張するのではなく、その安全制約を**検証可能、監査可能、実施可能**にします。

機密データの処理、財務上の決定、または重要なインフラストラクチャのサービスなど、高信頼環境で動作する OpenClaw ユーザーにとって、ClawGuard は暗号的に検証可能なエージェントセキュリティへの道を提供します。

---

**ClawGuard を試す準備はできましたか？** インストール手順とデモビデオについては、[GitHub リポジトリ](https://github.com/SaharaLabsAI/Verifiable-ClawGuard)をご覧ください。

**質問がありますか？** [トラブルシューティングガイド](/blog/troubleshooting)を参照するか、OpenClaw コミュニティディスカッションに参加してください。
