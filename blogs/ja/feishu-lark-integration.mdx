---
title: "Feishu/Lark と OpenClaw AI ボットを統合する方法"
description: "OpenClaw AI アシスタントを Feishu（中国版）および Lark（国際版）エンタープライズメッセージングプラットフォームに接続するための完全ガイド。中国企業コラボレーション向けのセットアップ、設定、高度な機能について学びます。"
slug: "feishu-lark-integration"
tags: ["Feishu", "Lark", "エンタープライズ", "統合", "中国市場", "WebSocket", "AI ボット"]
publishedAt: "2026-02-16"
status: "published"
visibility: "public"
featuredImageUrl: "/images/features/feishu-lark-integration.webp"
---

# Feishu/Lark と OpenClaw AI ボットを統合する方法

Feishu（飞书）と Lark は、中国およびグローバル企業でチームコラボレーションに広く使用されているエンタープライズメッセージングプラットフォームです。このガイドでは、WebSocket ベースのイベントサブスクリプションを使用して OpenClaw AI アシスタントを Feishu/Lark に接続し、企業チャット環境でシームレスな AI インタラクションを実現する方法を説明します。

## Feishu と Lark の違いは？

- **Feishu（飞书）**: 中国版で、中国企業向け。プラットフォーム：`https://open.feishu.cn`
- **Lark**: 国際版で、グローバルに使用されています。プラットフォーム：`https://open.larksuite.com`

どちらも同じ API アーキテクチャを使用していますが、OpenClaw で適切なドメインを設定する必要があります。

---

## 前提条件

始める前に、以下を確認してください：

- OpenClaw がインストールされ、実行されていること
- エンタープライズアプリを作成できる管理者権限を持つ Feishu/Lark アカウント
- ターミナル/コマンドラインの基本的な知識

---

## ステップ 1: Feishu プラグインをインストール

まず、OpenClaw 公式の Feishu プラグインをインストールします：

```bash
openclaw plugins install @openclaw/feishu
```

git リポジトリから実行している場合：

```bash
openclaw plugins install ./extensions/feishu
```

---

## ステップ 2: Feishu/Lark アプリを作成

### 1. 開発者プラットフォームを開く

お住まいの地域に応じて適切なプラットフォームにアクセスしてください：

- **Feishu（中国）**: [https://open.feishu.cn/app](https://open.feishu.cn/app)
- **Lark（国際）**: [https://open.larksuite.com/app](https://open.larksuite.com/app)

アカウントでサインインします。

### 2. エンタープライズアプリを作成

1. **エンタープライズアプリを作成**をクリック
2. アプリ名と説明を入力
3. アプリアイコンを選択

### 3. 認証情報をコピー

**認証情報と基本情報**から、以下をコピーします：

- **App ID**（形式：`cli_xxx`）
- **App Secret**

⚠️ **重要**：App Secret は非公開にし、バージョン管理にコミットしないでください。

### 4. 権限を設定

**権限**ページで、**一括インポート**をクリックし、次の JSON を貼り付けます：

```json
\{
  "scopes": \{
    "tenant": [
      "aily:file:read",
      "aily:file:write",
      "application:application.app_message_stats.overview:readonly",
      "application:application:self_manage",
      "application:bot.menu:write",
      "contact:user.employee_id:readonly",
      "corehr:file:download",
      "event:ip_list",
      "im:chat.access_event.bot_p2p_chat:read",
      "im:chat.members:bot_access",
      "im:message",
      "im:message.group_at_msg:readonly",
      "im:message.p2p_msg:readonly",
      "im:message:readonly",
      "im:message:send_as_bot",
      "im:resource"
    ],
    "user": [
      "aily:file:read",
      "aily:file:write",
      "im:chat.access_event.bot_p2p_chat:read"
    ]
  \}
\}
```

これにより、ボットがメッセージの送受信、ファイルへのアクセス、ボット機能の管理に必要なすべての権限が付与されます。

### 5. ボット機能を有効化

**アプリ機能** > **ボット**で：

1. ボット機能を有効化
2. ボット名を設定

### 6. イベントサブスクリプションを設定

⚠️ **重要**：イベントサブスクリプションを設定する前に、以下を確認してください：

1. OpenClaw に Feishu チャネルを追加済み（ステップ 3 参照）
2. OpenClaw ゲートウェイが実行中（`openclaw gateway status`）

**イベントサブスクリプション**で：

1. **長時間接続を使用してイベントを受信**（WebSocket モード）を選択
2. イベントを追加：`im.message.receive_v1`

⚠️ ゲートウェイが実行されていない場合、WebSocket 接続の設定は失敗します。

### 7. アプリを公開

1. **バージョン管理とリリース**でバージョンを作成
2. レビュー用に送信して公開
3. 管理者の承認を待つ（エンタープライズアプリは通常自動承認）

---

## ステップ 3: OpenClaw を設定

### 方法 1: インタラクティブセットアップ（推奨）

チャネルセットアップウィザードを実行します：

```bash
openclaw channels add
```

**Feishu** を選択し、プロンプトが表示されたら App ID と App Secret を入力します。

### 方法 2: 手動設定

`~/.openclaw/openclaw.json` を編集します：

```json5
\{
  channels: \{
    feishu: \{
      enabled: true,
      dmPolicy: "pairing",
      accounts: \{
        main: \{
          appId: "cli_xxx",
          appSecret: "xxx",
          botName: "My AI Assistant",
        \},
      \},
    \},
  \},
\}
```

### Lark（国際版）の場合

Feishu ではなく Lark を使用している場合は、`domain` 設定を追加します：

```json5
\{
  channels: \{
    feishu: \{
      domain: "lark",
      accounts: \{
        main: \{
          appId: "cli_xxx",
          appSecret: "xxx",
        \},
      \},
    \},
  \},
\}
```

---

## ステップ 4: 起動とテスト

### 1. ゲートウェイを起動

```bash
openclaw gateway
```

ゲートウェイのステータスを確認：

```bash
openclaw gateway status
```

### 2. テストメッセージを送信

Feishu/Lark でボットを見つけてメッセージを送信します。

### 3. ペアリングを承認

デフォルトでは、ボットはセキュリティのためにペアリングモードを使用します。新しいユーザーがボットにメッセージを送信すると、ペアリングコードを受け取ります。

ペアリングを承認：

```bash
openclaw pairing list feishu
openclaw pairing approve feishu <コード>
```

承認後、ボットと正常にチャットできます。

---

## 高度な機能

### グループチャット設定

**デフォルトの動作**：グループチャットでは、ボットが応答するには @メンションが必要です。

特定のグループでボットが @メンション なしで応答できるようにするには：

```json5
\{
  channels: \{
    feishu: \{
      groups: \{
        oc_xxx: \{ requireMention: false \},
      \},
    \},
  \},
\}
```

**グループ ID を取得**：グループで @メンション付きのメッセージを送信し、ログを確認します：

```bash
openclaw logs --follow
```

`chat_id`（形式：`oc_xxx`）を探します。

### アクセス制御ポリシー

**DM ポリシー**（`dmPolicy`）：

- `"pairing"`（デフォルト）：新しいユーザーには管理者の承認が必要
- `"allowlist"`：特定のユーザーのみがチャット可能
- `"open"`：すべてのユーザーを許可（allowFrom に `"*"` が必要）
- `"disabled"`：DM を無効化

**グループポリシー**（`groupPolicy`）：

- `"open"`（デフォルト）：グループ内のすべてのユーザーを許可
- `"allowlist"`：`groupAllowFrom` の特定のユーザーのみ
- `"disabled"`：グループメッセージを無効化

許可リスト設定の例：

```json5
\{
  channels: \{
    feishu: \{
      groupPolicy: "allowlist",
      groupAllowFrom: ["ou_xxx", "ou_yyy"],
    \},
  \},
\}
```

### 複数アカウント

複数の Feishu/Lark ボットを管理できます：

```json5
\{
  channels: \{
    feishu: \{
      accounts: \{
        main: \{
          appId: "cli_xxx",
          appSecret: "xxx",
          botName: "プライマリボット",
        \},
        backup: \{
          appId: "cli_yyy",
          appSecret: "yyy",
          botName: "バックアップボット",
          enabled: false,
        \},
      \},
    \},
  \},
\}
```

---

## トラブルシューティング

### グループでボットが応答しない

1. ボットがグループに追加されていることを確認
2. ボットを @メンションしていることを確認（デフォルトの動作）
3. `groupPolicy` が `"disabled"` に設定されていないか確認
4. ログを確認：`openclaw logs --follow`

### ボットがメッセージを受信しない

1. アプリが公開され承認されていることを確認
2. イベントサブスクリプションに `im.message.receive_v1` が含まれていることを確認
3. **長時間接続**（WebSocket）が有効になっていることを確認
4. すべての権限が付与されていることを確認
5. ゲートウェイが実行中であることを確認：`openclaw gateway status`
6. ログを確認：`openclaw logs --follow`

### App Secret が漏洩した場合

1. Feishu/Lark オープンプラットフォームで App Secret をリセット
2. OpenClaw 設定の App Secret を更新
3. ゲートウェイを再起動：`openclaw gateway restart`

### メッセージ送信の失敗

1. アプリに `im:message:send_as_bot` 権限があることを確認
2. アプリが公開されていることを確認
3. 詳細なエラーメッセージについてログを確認

---

## よく使うコマンド

| コマンド  | 説明                 |
| --------- | -------------------- |
| `/status` | ボットのステータスを表示 |
| `/reset`  | セッションをリセット |
| `/model`  | モデルを表示/切り替え |

---

## サポートされているメッセージタイプ

**受信**：
- ✅ テキスト
- ✅ 画像
- ✅ ファイル
- ✅ 音声
- ✅ 動画
- ✅ スタンプ

**送信**：
- ✅ テキスト
- ✅ 画像
- ✅ ファイル
- ✅ 音声
- ⚠️ リッチテキスト（部分的にサポート）

---

## まとめ

OpenClaw と Feishu/Lark の統合が完了しました！この設定により、チームは企業メッセージングプラットフォームで AI と直接対話できるようになります。中国版の Feishu でも国際版の Lark でも使用可能です。

**要点**：
- Feishu と Lark は同じ API を使用し、ドメインのみが異なる
- WebSocket モードにより、パブリック webhook URL が不要
- ペアリングモードにより、エンタープライズ使用のための安全なアクセス制御を提供
- DM とグループチャットの両方を完全サポートし、柔軟なポリシーを提供

詳細な設定オプションについては、[OpenClaw 公式ドキュメント](https://docs.openclaw.ai)を確認してください。
