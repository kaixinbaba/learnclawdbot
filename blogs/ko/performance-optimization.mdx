---
title: OpenClaw 성능 최적화 가이드 - 지연 및 메모리 누수 해결
description: 토큰 최적화, 메모리 관리, 세션 프루닝 전략을 포함한 OpenClaw의 일반적인 성능 문제를 식별하고 해결하는 종합 가이드
slug: /performance-optimization
publishedAt: 2026-02-14
status: published
visibility: public
featuredImageUrl: /images/features/performance_optimization.webp
---

# OpenClaw 성능 최적화 가이드: 지연 및 메모리 누수 해결

OpenClaw를 며칠 또는 몇 주 동안 원활하게 실행하려면 리소스 관리 방식을 이해해야 합니다. 이 가이드에서는 일반적인 성능 병목 현상과 AI 어시스턴트를 빠르고 효율적으로 유지하기 위한 실용적인 솔루션을 다룹니다.

## 토큰 사용량 및 비용 이해

AI 모델과의 모든 상호작용은 토큰을 소비하며, 이는 성능과 비용 모두에 직접적인 영향을 미칩니다. OpenClaw는 다음 전반에 걸쳐 토큰 사용량을 포괄적으로 추적합니다:

- 시스템 프롬프트 (도구, 스킬, 워크스페이스 파일)
- 대화 기록
- 도구 호출 및 결과
- 첨부 파일 및 트랜스크립트
- 캐시 작업

### 토큰 소비 모니터링

실시간으로 사용량을 추적하려면 다음 명령을 사용하세요:

**현재 세션 상태 확인:**
```
/status
```
모델, 컨텍스트 사용량, 예상 비용을 표시합니다.

**응답별 사용량 푸터 활성화:**
```
/usage full
```
모든 응답 후에 상세한 토큰 메트릭을 추가합니다.

**비용 요약 보기:**
```
/usage cost
```
세션 로그에서 누적 비용을 표시합니다.

### 토큰 최적화 전략

**1. 도구 출력 제한**

대용량 도구 결과(파일 읽기, 웹 페치)는 상당한 토큰을 소비합니다. 설정에서 출력 제한을 구성하세요:

```json
{
  "tools": {
    "read": {
      "maxChars": 50000
    }
  }
}
```

**2. 세션 프루닝 사용**

OpenClaw는 모델에 컨텍스트를 보내기 전에 오래된 도구 결과를 자동으로 트리밍할 수 있습니다. cache-TTL 프루닝 활성화:

```json
{
  "agents": {
    "defaults": {
      "contextPruning": {
        "mode": "cache-ttl",
        "ttl": "5m",
        "keepLastAssistants": 3
      }
    }
  }
}
```

**작동 방식:**
- 마지막 3개의 어시스턴트 메시지와 해당 도구 결과만 유지
- 오래된 도구 출력 트림 또는 삭제
- 캐시 TTL이 만료될 때만 실행
- 이미지가 포함된 도구 결과 보호

**3. 프롬프트 캐싱 활용**

Anthropic 모델의 경우, 프롬프트 캐싱은 반복 컨텍스트의 비용을 크게 줄입니다:

```json
{
  "agents": {
    "defaults": {
      "model": {
        "primary": "anthropic/claude-opus-4-5"
      },
      "models": {
        "anthropic/claude-opus-4-5": {
          "params": {
            "cacheRetention": "long"
          }
        }
      }
    }
  }
}
```

**캐시 최적화 팁:**
- 캐시 TTL은 일반적으로 5분 (Anthropic)
- 1시간 TTL용 캐시를 유지하려면 하트비트(`every: "55m"`) 사용
- 캐시 읽기는 입력 토큰보다 10배 저렴
- 캐시 만료 전 프루닝으로 캐시 쓰기 비용 감소

**4. 긴 세션 압축**

대화가 너무 길어지면 OpenClaw가 오래된 메시지를 요약할 수 있습니다:

```
/compact 핵심 결정과 미해결 질문에 집중
```

컨텍스트 제한에 가까워지면 자동 압축이 트리거됩니다. 임계값 구성:

```json
{
  "agents": {
    "defaults": {
      "compaction": {
        "autoCompact": true,
        "targetRatio": 0.8,
        "minMessagesBeforeCompact": 10
      }
    }
  }
}
```

## 세션 및 메모리 관리

### 세션 수명 주기 모범 사례

**오래된 세션 리셋:**
```
/reset
```
디스크의 대화 기록을 유지하면서 컨텍스트를 지웁니다.

**새로 시작:**
```
/new
```
깨끗한 상태로 새 세션을 만듭니다.

**세션 상태 확인:**
```
/context detail
```
컨텍스트 창에 대한 파일별 기여도를 표시합니다.

### 메모리 파일 최적화

OpenClaw는 각 세션 시작 시 워크스페이스 파일(`AGENTS.md`, `SOUL.md`, `TOOLS.md` 등)을 로드합니다. 이를 간결하게 유지하세요:

**부트스트랩 파일 크기 제한:**
```json
{
  "agents": {
    "defaults": {
      "bootstrapMaxChars": 20000
    }
  }
}
```

**모범 사례:**
- `AGENTS.md`는 워크플로우 규칙에 집중
- 상세 참조는 별도 파일에 저장하고 필요 시 로드
- 오래된 `memory/YYYY-MM-DD.md` 파일 정기적으로 아카이브
- 오래된 컨텍스트를 제거하여 `MEMORY.md` 압축

## 일반적인 성능 함정

### 1. **무제한 도구 출력**

**문제:** 대용량 로그 파일 읽기나 전체 웹 페이지 가져오기가 컨텍스트를 부풀림.

**해결책:**
```json
{
  "tools": {
    "read": {
      "maxChars": 10000
    },
    "exec": {
      "outputMaxChars": 5000
    }
  }
}
```

### 2. **잊혀진 하트비트**

**문제:** 매분 하트비트 체크가 토큰을 소모함.

**해결책:** 필요에 따라 30분~1시간으로 조정:
```json
{
  "agents": {
    "defaults": {
      "heartbeat": {
        "every": "30m"
      }
    }
  }
}
```

### 3. **오래된 캐시 쓰기**

**문제:** 세션이 캐시 TTL을 초과하여 유휴 상태가 되면 다음 요청에서 전체 프롬프트를 다시 씀.

**해결책:** cache-TTL 프루닝을 활성화하여 캐시 창 리셋:
```json
{
  "agents": {
    "defaults": {
      "contextPruning": {
        "mode": "cache-ttl",
        "ttl": "5m"
      }
    }
  }
}
```

### 4. **도구 결과의 이미지 첨부**

**문제:** 이미지는 대량의 토큰을 소비.

**해결책:**
- 세션 프루닝은 이미지가 포함된 도구 결과를 건너뜀
- 컨텍스트가 가득 차면 수동으로 `/reset`
- 이미지가 쌓이기 전에 `/compact`를 사용하여 요약

### 5. **진단 과부하**

**문제:** 높은 샘플 속도로 모든 진단을 OpenTelemetry로 내보내기.

**해결책:** 샘플링 사용 및 로그 수준으로 필터링:
```json
{
  "diagnostics": {
    "otel": {
      "sampleRate": 0.1,
      "logs": false
    }
  }
}
```

## 프로덕션 권장 구성

비용과 성능의 균형 잡힌 설정:

```json
{
  "agents": {
    "defaults": {
      "model": {
        "primary": "anthropic/claude-sonnet-4-5"
      },
      "models": {
        "anthropic/claude-sonnet-4-5": {
          "params": {
            "cacheRetention": "long"
          }
        }
      },
      "contextPruning": {
        "mode": "cache-ttl",
        "ttl": "5m",
        "keepLastAssistants": 3,
        "softTrimRatio": 0.3
      },
      "compaction": {
        "autoCompact": true,
        "targetRatio": 0.8,
        "minMessagesBeforeCompact": 10
      },
      "heartbeat": {
        "every": "30m"
      },
      "bootstrapMaxChars": 20000
    }
  },
  "logging": {
    "level": "info",
    "consoleLevel": "info",
    "redactSensitive": "tools"
  },
  "tools": {
    "read": {
      "maxChars": 50000
    },
    "exec": {
      "outputMaxChars": 10000
    }
  }
}
```

## 문제 해결 체크리스트

지연이나 높은 비용이 발생할 때:

1. **토큰 사용량 확인:** `/status` 및 `/usage full`
2. **컨텍스트 크기 검토:** `/context detail`
3. **멈춘 세션 찾기:** `openclaw status`
4. **로그 확인:** `openclaw logs --follow`
5. **큐 깊이 확인:** 메트릭에서 `openclaw.queue.depth` 확인
6. **캐시 동작 검증:** 로그에서 빈번한 `cacheWrite` 확인
7. **도구 출력 감사:** `--raw-stream`으로 실제 응답 확인
8. **압축 테스트:** `/compact` 후 응답 시간 비교
9. **비용 모니터링:** `/usage cost`로 비싼 패턴 발견
10. **필요시 리셋:** 오래된 세션에는 `/reset`

---

**프로 팁:** 구성 문제를 조기에 발견하려면 정기적으로 `openclaw doctor`를 실행하세요. 성능 최적화는 반복적인 과정입니다 — 모니터링, 조정, 테스트!
