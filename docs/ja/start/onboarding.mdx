---
summary: "OpenClaw（macOSアプリ）の初回オンボーディングフロー"
read_when:
  - macOSオンボーディングアシスタントを設計する時
  - 認証またはアイデンティティセットアップを実装する時
---
# オンボーディング（macOSアプリ）

このドキュメントは、**現在の**初回実行オンボーディングフローを説明しています。目標は、
スムーズな「0日目」の体験：Gatewayの実行場所を選択し、認証を接続し、ウィザードを実行し、エージェントに自身をブートストラップさせることです。

## ページの順序（現在）

1) ようこそ + セキュリティ通知
2) **Gateway選択**（ローカル / リモート / 後で設定）
3) **認証（Anthropic OAuth）** — ローカルのみ
4) **セットアップウィザード**（Gateway駆動）
5) **権限**（TCCプロンプト）
6) **CLI**（オプション）
7) **オンボーディングチャット**（専用セッション）
8) 準備完了

## 1) ローカル vs リモート

**Gateway**はどこで実行されますか？

- **ローカル（このMac）：** オンボーディングはOAuthフローを実行し、認証情報を
  ローカルに書き込むことができます。
- **リモート（SSH/Tailnet経由）：** オンボーディングはOAuthをローカルで実行**しません**；
  認証情報はgatewayホスト上に存在する必要があります。
- **後で設定：** セットアップをスキップし、アプリを未設定のままにします。

Gateway認証のヒント：
- ウィザードはループバックの場合でも**トークン**を生成するようになったため、ローカルWSクライアントは認証する必要があります。
- 認証を無効にすると、任意のローカルプロセスが接続できます；完全に信頼できるマシンでのみ使用してください。
- マルチマシンアクセスまたは非ループバックバインドには**トークン**を使用してください。

## 2) ローカルのみの認証（Anthropic OAuth）

macOSアプリはAnthropicのOAuth（Claude Pro/Max）をサポートしています。フロー：

- OAuth用のブラウザを開きます（PKCE）
- ユーザーに`code#state`値を貼り付けるよう求めます
- 認証情報を`~/.openclaw/credentials/oauth.json`に書き込みます

他のプロバイダー（OpenAI、カスタムAPI）は、現在のところ環境変数
または設定ファイルを介して設定されます。

## 3) セットアップウィザード（Gateway駆動）

アプリはCLIと同じセットアップウィザードを実行できます。これにより、オンボーディングが
Gateway側の動作と同期し、SwiftUIでロジックを重複させることを避けます。

## 4) 権限

オンボーディングは以下に必要なTCC権限を要求します：

- 通知
- アクセシビリティ
- 画面録画
- マイク / 音声認識
- オートメーション（AppleScript）

## 5) CLI（オプション）

アプリはnpm/pnpm経由でグローバル`openclaw` CLIをインストールできるため、ターミナル
ワークフローとlaunchdタスクがすぐに機能します。

## 6) オンボーディングチャット（専用セッション）

セットアップ後、アプリは専用のオンボーディングチャットセッションを開き、エージェントが
自己紹介し、次のステップをガイドできるようにします。これにより、初回実行ガイダンスが
通常の会話から分離されます。

## エージェントブートストラップ儀式

最初のエージェント実行時、OpenClawはワークスペース（デフォルト`~/.openclaw/workspace`）をブートストラップします：

- `AGENTS.md`、`BOOTSTRAP.md`、`IDENTITY.md`、`USER.md`をシードします
- 短いQ&A儀式を実行します（一度に1つの質問）
- アイデンティティ + 好みを`IDENTITY.md`、`USER.md`、`SOUL.md`に書き込みます
- 終了時に`BOOTSTRAP.md`を削除し、一度だけ実行されるようにします

## オプション：Gmailフック（手動）

Gmail Pub/Subセットアップは現在手動ステップです。使用：

```bash
openclaw webhooks gmail setup --account you@gmail.com
```

詳細は[/automation/gmail-pubsub](/automation/gmail-pubsub)を参照してください。

## リモートモードの注意事項

Gatewayが別のマシンで実行される場合、認証情報とワークスペースファイルは
**そのホスト上に**存在します。リモートモードでOAuthが必要な場合は、以下を作成してください：

- `~/.openclaw/credentials/oauth.json`
- `~/.openclaw/agents/<agentId>/agent/auth-profiles.json`

gatewayホスト上で。
