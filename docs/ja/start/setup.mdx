---
summary: "セットアップガイド：最新状態を保ちながらOpenClawセットアップをカスタマイズする"
read_when:
  - 新しいマシンをセットアップする時
  - 個人設定を壊さずに「最新かつ最高」を求める時
---

# セットアップ

最終更新：2026-01-01

## TL;DR
- **カスタマイズはリポジトリの外に：** `~/.openclaw/workspace`（ワークスペース） + `~/.openclaw/openclaw.json`（設定）。
- **安定したワークフロー：** macOSアプリをインストール；バンドルされたGatewayを実行させます。
- **最先端のワークフロー：** `pnpm gateway:watch`経由でGatewayを自分で実行し、macOSアプリをローカルモードでアタッチさせます。

## 前提条件（ソースから）
- Node `>=22`
- `pnpm`
- Docker（オプション；コンテナ化されたセットアップ/e2eのみ — [Docker](/install/docker)を参照）

## カスタマイズ戦略（更新が痛くないように）

「100%自分用」*かつ*簡単な更新が必要な場合は、カスタマイズを以下に保持してください：

- **設定：** `~/.openclaw/openclaw.json`（JSON/JSON5風）
- **ワークスペース：** `~/.openclaw/workspace`（スキル、プロンプト、メモリ；非公開gitリポジトリにしてください）

一度ブートストラップ：

```bash
openclaw setup
```

このリポジトリ内から、ローカルCLIエントリを使用：

```bash
openclaw setup
```

グローバルインストールがまだない場合は、`pnpm openclaw setup`経由で実行してください。

## 安定したワークフロー（macOSアプリ優先）

1) **OpenClaw.app**（メニューバー）をインストール + 起動。
2) オンボーディング/権限チェックリストを完了（TCCプロンプト）。
3) Gatewayが**ローカル**で実行されていることを確認（アプリが管理します）。
4) サーフェスをリンク（例：WhatsApp）：

```bash
openclaw channels login
```

5) サニティチェック：

```bash
openclaw health
```

ビルドでオンボーディングが利用できない場合：
- `openclaw setup`を実行し、次に`openclaw channels login`を実行してから、Gatewayを手動で起動します（`openclaw gateway`）。

## 最先端のワークフロー（ターミナルでGateway）

目標：TypeScript Gateway上で作業し、ホットリロードを取得し、macOSアプリのUIをアタッチしたままにする。

### 0)（オプション）macOSアプリもソースから実行

macOSアプリも最先端にしたい場合：

```bash
./scripts/restart-mac.sh
```

### 1) 開発Gatewayを起動

```bash
pnpm install
pnpm gateway:watch
```

`gateway:watch`はウォッチモードでgatewayを実行し、TypeScriptの変更時にリロードします。

### 2) macOSアプリを実行中のGatewayに向ける

**OpenClaw.app**で：

- 接続モード：**ローカル**
アプリは設定されたポート上で実行中のgatewayにアタッチします。

### 3) 確認

- アプリ内のGatewayステータスは**「既存のgatewayを使用中…」**と表示されるはずです
- またはCLI経由：

```bash
openclaw health
```

### よくある落とし穴
- **間違ったポート：** Gateway WSはデフォルトで`ws://127.0.0.1:18789`；アプリ + CLIを同じポートに保ちます。
- **状態が保存される場所：**
  - 認証情報：`~/.openclaw/credentials/`
  - セッション：`~/.openclaw/agents/<agentId>/sessions/`
  - ログ：`/tmp/openclaw/`

## 認証情報ストレージマップ

認証のデバッグやバックアップするものを決定する際に使用：

- **WhatsApp**：`~/.openclaw/credentials/whatsapp/<accountId>/creds.json`
- **Telegramボットトークン**：設定/環境または`channels.telegram.tokenFile`
- **Discordボットトークン**：設定/環境（トークンファイルはまだサポートされていません）
- **Slackトークン**：設定/環境（`channels.slack.*`）
- **ペアリング許可リスト**：`~/.openclaw/credentials/<channel>-allowFrom.json`
- **モデル認証プロファイル**：`~/.openclaw/agents/<agentId>/agent/auth-profiles.json`
- **レガシーOAuthインポート**：`~/.openclaw/credentials/oauth.json`
詳細：[Security](/gateway/security#credential-storage-map)。

## 更新（セットアップを壊さずに）

- `~/.openclaw/workspace`と`~/.openclaw/`を「あなたのもの」として保持；個人のプロンプト/設定を`openclaw`リポジトリに入れないでください。
- ソースの更新：`git pull` + `pnpm install`（lockfileが変更された時） + `pnpm gateway:watch`を使い続けます。

## Linux（systemdユーザーサービス）

Linuxインストールはsystemd **ユーザー**サービスを使用します。デフォルトでは、systemdは
ログアウト/アイドル時にユーザーサービスを停止し、Gatewayを終了させます。オンボーディングは
あなたのためにlingeringを有効にしようとします（sudoを求める場合があります）。まだオフの場合は、実行：

```bash
sudo loginctl enable-linger $USER
```

常時接続またはマルチユーザーサーバーの場合は、ユーザーサービスの代わりに**システム**サービスを検討してください
（lingeringは不要）。systemdの注意事項については[Gateway runbook](/gateway)を参照してください。

## 関連ドキュメント

- [Gateway runbook](/gateway)（フラグ、監視、ポート）
- [Gateway configuration](/gateway/configuration)（設定スキーマ + 例）
- [Discord](/channels/discord) と [Telegram](/channels/telegram)（返信タグ + replyToMode設定）
- [OpenClaw assistant setup](/start/openclaw)
- [macOS app](/platforms/macos)（gatewayライフサイクル）
