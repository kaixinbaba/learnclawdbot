---
summary: "インストーラースクリプトの仕組み（install.sh + install-cli.sh）、フラグ、自動化"
read_when:
  - `openclaw.bot/install.sh`を理解したい場合
  - インストールを自動化したい場合（CI / ヘッドレス）
  - GitHubチェックアウトからインストールしたい場合
---

# インストーラー内部

OpenClawは2つのインストーラースクリプトを提供しています（`openclaw.ai`から提供）:

- `https://openclaw.bot/install.sh` — 「推奨」インストーラー（デフォルトでnpmグローバルインストール、GitHubチェックアウトからもインストール可能）
- `https://openclaw.bot/install-cli.sh` — 非root向けCLIインストーラー（独自のNodeを持つプレフィックスにインストール）
 - `https://openclaw.ai/install.ps1` — Windows PowerShellインストーラー（デフォルトでnpm、オプションのgitインストール）

現在のフラグ/動作を確認するには:

```bash
curl -fsSL https://openclaw.bot/install.sh | bash -s -- --help
```

Windows（PowerShell）ヘルプ:

```powershell
& ([scriptblock]::Create((iwr -useb https://openclaw.ai/install.ps1))) -?
```

インストーラーが完了したが新しいターミナルで`openclaw`が見つからない場合は、通常Node/npm PATHの問題です。参照: [Install](/install#nodejs--npm-path-sanity)。

## install.sh（推奨）

高レベルでの動作:

- OSの検出（macOS / Linux / WSL）。
- Node.js **22+**を確保（macOSはHomebrew経由、LinuxはNodeSource経由）。
- インストール方法の選択:
  - `npm`（デフォルト）: `npm install -g openclaw@latest`
  - `git`: ソースチェックアウトをクローン/ビルドし、ラッパースクリプトをインストール
- Linux: 必要に応じてnpmのプレフィックスを`~/.npm-global`に切り替えることで、グローバルnpmパーミッションエラーを回避。
- 既存のインストールをアップグレードする場合: `openclaw doctor --non-interactive`を実行（ベストエフォート）。
- gitインストールの場合: インストール/更新後に`openclaw doctor --non-interactive`を実行（ベストエフォート）。
- デフォルトで`SHARP_IGNORE_GLOBAL_LIBVIPS=1`を設定することで`sharp`ネイティブインストールの問題を軽減（システムlibvipsに対するビルドを回避）。

グローバルにインストールされたlibvipsに対して`sharp`をリンク*させたい*場合（またはデバッグ中の場合）は、以下を設定してください:

```bash
SHARP_IGNORE_GLOBAL_LIBVIPS=0 curl -fsSL https://openclaw.bot/install.sh | bash
```

### 発見可能性 / "gitインストール"プロンプト

**既にOpenClawソースチェックアウト内**でインストーラーを実行すると（`package.json` + `pnpm-workspace.yaml`で検出）、プロンプトが表示されます:

- このチェックアウトを更新して使用（`git`）
- またはnpmグローバルインストールに移行（`npm`）

非対話型コンテキスト（TTYなし / `--no-prompt`）では、`--install-method git|npm`を渡す必要があります（または`OPENCLAW_INSTALL_METHOD`を設定）、そうでない場合スクリプトはコード`2`で終了します。

### Gitが必要な理由

Gitは`--install-method git`パス（クローン/プル）に必須です。

`npm`インストールの場合、Gitは*通常*不要ですが、一部の環境ではまだ必要になります（例: パッケージまたは依存関係がgit URL経由でフェッチされる場合）。インストーラーは現在、新しいディストロでの`spawn git ENOENT`サプライズを回避するためにGitが存在することを確保します。

### なぜnpmが新しいLinuxで`EACCES`になるか

一部のLinuxセットアップ（特にシステムパッケージマネージャーまたはNodeSource経由でNodeをインストールした後）では、npmのグローバルプレフィックスがroot所有の場所を指します。その場合、`npm install -g ...`は`EACCES` / `mkdir`パーミッションエラーで失敗します。

`install.sh`は、プレフィックスを以下に切り替えることでこれを軽減します:

- `~/.npm-global`（存在する場合、`~/.bashrc` / `~/.zshrc`のPATHに追加）

## install-cli.sh（非rootCLIインストーラー）

このスクリプトは`openclaw`をプレフィックス（デフォルト: `~/.openclaw`）にインストールし、そのプレフィックス下に専用のNodeランタイムもインストールするため、システムのNode/npmに触れたくないマシンで動作します。

ヘルプ:

```bash
curl -fsSL https://openclaw.bot/install-cli.sh | bash -s -- --help
```

## install.ps1（Windows PowerShell）

高レベルでの動作:

- Node.js **22+**を確保（winget/Chocolatey/Scoop または 手動）。
- インストール方法の選択:
  - `npm`（デフォルト）: `npm install -g openclaw@latest`
  - `git`: ソースチェックアウトをクローン/ビルドし、ラッパースクリプトをインストール
- アップグレードおよびgitインストール時に`openclaw doctor --non-interactive`を実行（ベストエフォート）。

例:

```powershell
iwr -useb https://openclaw.ai/install.ps1 | iex
```

```powershell
iwr -useb https://openclaw.ai/install.ps1 | iex -InstallMethod git
```

```powershell
iwr -useb https://openclaw.ai/install.ps1 | iex -InstallMethod git -GitDir "C:\\openclaw"
```

環境変数:

- `OPENCLAW_INSTALL_METHOD=git|npm`
- `OPENCLAW_GIT_DIR=...`

Git要件:

`-InstallMethod git`を選択してGitが不足している場合、インストーラーは
Git for Windowsリンク（`https://git-scm.com/download/win`）を表示して終了します。

Windows共通の問題:

- **npm error spawn git / ENOENT**: Git for Windowsをインストールし、PowerShellを再度開いてから、インストーラーを再実行してください。
- **"openclaw" is not recognized**: npmグローバルbinフォルダがPATH上にありません。ほとんどのシステムは
  `%AppData%\\npm`を使用します。`npm config get prefix`を実行して`\\bin`をPATHに追加し、PowerShellを再度開くこともできます。
