---
summary: "èœå•æ çŠ¶æ€é€»è¾‘ä»¥åŠå‘ç”¨æˆ·æ˜¾ç¤ºçš„å†…å®¹"
read_when:
  - è°ƒæ•´ mac èœå• UI æˆ–çŠ¶æ€é€»è¾‘
---
# èœå•æ çŠ¶æ€é€»è¾‘

## æ˜¾ç¤ºå†…å®¹
- æˆ‘ä»¬åœ¨èœå•æ å›¾æ ‡å’Œèœå•çš„ç¬¬ä¸€ä¸ªçŠ¶æ€è¡Œä¸­æ˜¾ç¤ºå½“å‰ agent å·¥ä½œçŠ¶æ€ã€‚
- å·¥ä½œæ´»è·ƒæ—¶éšè—å¥åº·çŠ¶æ€ï¼›æ‰€æœ‰ä¼šè¯ç©ºé—²æ—¶è¿”å›ã€‚
- èœå•ä¸­çš„"Nodes"å—**ä»…**åˆ—å‡ºè®¾å¤‡ï¼ˆé€šè¿‡ `node.list` é…å¯¹çš„èŠ‚ç‚¹ï¼‰ï¼Œè€Œé client/presence æ¡ç›®ã€‚
- å½“ provider ä½¿ç”¨å¿«ç…§å¯ç”¨æ—¶ï¼ŒContext ä¸‹ä¼šå‡ºç°"Usage"éƒ¨åˆ†ã€‚

## çŠ¶æ€æ¨¡å‹
- ä¼šè¯ï¼ˆSessionsï¼‰ï¼šäº‹ä»¶å¸¦æœ‰ `runId`ï¼ˆæ¯æ¬¡è¿è¡Œï¼‰åŠ ä¸Šè´Ÿè½½ä¸­çš„ `sessionKey`ã€‚"main"ä¼šè¯çš„é”®æ˜¯ `main`ï¼›å¦‚æœç¼ºå¤±ï¼Œæˆ‘ä»¬å›é€€åˆ°æœ€è¿‘æ›´æ–°çš„ä¼šè¯ã€‚
- ä¼˜å…ˆçº§ï¼šmain æ€»æ˜¯ä¼˜å…ˆã€‚å¦‚æœ main æ´»è·ƒï¼Œå…¶çŠ¶æ€ç«‹å³æ˜¾ç¤ºã€‚å¦‚æœ main ç©ºé—²ï¼Œæ˜¾ç¤ºæœ€è¿‘æ´»è·ƒçš„é main ä¼šè¯ã€‚æˆ‘ä»¬ä¸ä¼šåœ¨æ´»åŠ¨ä¸­é€”ç¿»è½¬ï¼›ä»…åœ¨å½“å‰ä¼šè¯ç©ºé—²æˆ– main å˜æ´»è·ƒæ—¶åˆ‡æ¢ã€‚
- æ´»åŠ¨ç±»å‹ï¼ˆActivity kindsï¼‰ï¼š
  - `job`ï¼šé«˜çº§å‘½ä»¤æ‰§è¡Œï¼ˆ`state: started|streaming|done|error`ï¼‰ã€‚
  - `tool`ï¼š`phase: start|result` å¸¦æœ‰ `toolName` å’Œ `meta/args`ã€‚

## IconState æšä¸¾ï¼ˆSwiftï¼‰
- `idle`
- `workingMain(ActivityKind)`
- `workingOther(ActivityKind)`
- `overridden(ActivityKind)`ï¼ˆè°ƒè¯•è¦†ç›–ï¼‰

### ActivityKind â†’ å›¾æ ‡
- `exec` â†’ ğŸ’»
- `read` â†’ ğŸ“„
- `write` â†’ âœï¸
- `edit` â†’ ğŸ“
- `attach` â†’ ğŸ“
- é»˜è®¤ â†’ ğŸ› ï¸

### è§†è§‰æ˜ å°„
- `idle`ï¼šæ­£å¸¸å°åŠ¨ç‰©ã€‚
- `workingMain`ï¼šå¸¦å›¾æ ‡çš„å¾½ç« ï¼Œå®Œå…¨ç€è‰²ï¼Œè…¿éƒ¨"å·¥ä½œ"åŠ¨ç”»ã€‚
- `workingOther`ï¼šå¸¦å›¾æ ‡çš„å¾½ç« ï¼ŒæŸ”å’Œç€è‰²ï¼Œæ— è·‘åŠ¨ã€‚
- `overridden`ï¼šä½¿ç”¨é€‰æ‹©çš„å›¾æ ‡/ç€è‰²ï¼Œæ— è®ºæ´»åŠ¨å¦‚ä½•ã€‚

## çŠ¶æ€è¡Œæ–‡æœ¬ï¼ˆèœå•ï¼‰
- å·¥ä½œæ´»è·ƒæ—¶ï¼š`<ä¼šè¯è§’è‰²> Â· <æ´»åŠ¨æ ‡ç­¾>`
  - ç¤ºä¾‹ï¼š`Main Â· exec: pnpm test`ã€`Other Â· read: apps/macos/Sources/OpenClaw/AppState.swift`ã€‚
- ç©ºé—²æ—¶ï¼šå›é€€åˆ°å¥åº·æ‘˜è¦ã€‚

## äº‹ä»¶æ‘„å–
- æ¥æºï¼šcontrol-channel `agent` äº‹ä»¶ï¼ˆ`ControlChannel.handleAgentEvent`ï¼‰ã€‚
- è§£æå­—æ®µï¼š
  - `stream: "job"` å¸¦æœ‰ `data.state` ç”¨äºå¼€å§‹/åœæ­¢ã€‚
  - `stream: "tool"` å¸¦æœ‰ `data.phase`ã€`name`ã€å¯é€‰ `meta`/`args`ã€‚
- æ ‡ç­¾ï¼š
  - `exec`ï¼š`args.command` çš„ç¬¬ä¸€è¡Œã€‚
  - `read`/`write`ï¼šç¼©çŸ­çš„è·¯å¾„ã€‚
  - `edit`ï¼šè·¯å¾„åŠ ä¸Šä» `meta`/diff è®¡æ•°æ¨æ–­çš„æ›´æ”¹ç±»å‹ã€‚
  - å›é€€ï¼šå·¥å…·åç§°ã€‚

## è°ƒè¯•è¦†ç›–
- è®¾ç½® â–¸ Debug â–¸ "Icon override"é€‰æ‹©å™¨ï¼š
  - `System (auto)`ï¼ˆé»˜è®¤ï¼‰
  - `Working: main`ï¼ˆæŒ‰å·¥å…·ç±»å‹ï¼‰
  - `Working: other`ï¼ˆæŒ‰å·¥å…·ç±»å‹ï¼‰
  - `Idle`
- é€šè¿‡ `@AppStorage("iconOverride")` å­˜å‚¨ï¼›æ˜ å°„åˆ° `IconState.overridden`ã€‚

## æµ‹è¯•æ¸…å•
- è§¦å‘ main ä¼šè¯ä½œä¸šï¼šéªŒè¯å›¾æ ‡ç«‹å³åˆ‡æ¢ï¼ŒçŠ¶æ€è¡Œæ˜¾ç¤º main æ ‡ç­¾ã€‚
- åœ¨ main ç©ºé—²æ—¶è§¦å‘é main ä¼šè¯ä½œä¸šï¼šå›¾æ ‡/çŠ¶æ€æ˜¾ç¤ºé mainï¼›ä¿æŒç¨³å®šç›´åˆ°å®Œæˆã€‚
- åœ¨å…¶ä»–æ´»è·ƒæ—¶å¯åŠ¨ mainï¼šå›¾æ ‡ç«‹å³ç¿»è½¬åˆ° mainã€‚
- å¿«é€Ÿå·¥å…·çˆ†å‘ï¼šç¡®ä¿å¾½ç« ä¸é—ªçƒï¼ˆå·¥å…·ç»“æœä¸Šçš„ TTL å®½é™æœŸï¼‰ã€‚
- æ‰€æœ‰ä¼šè¯ç©ºé—²åå¥åº·è¡Œé‡æ–°å‡ºç°ã€‚
