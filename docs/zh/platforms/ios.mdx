---
summary: "iOS 节点应用：连接到 Gateway（网关）、配对、Canvas 和故障排除"
read_when:
  - 配对或重新连接 iOS 节点
  - 从源代码运行 iOS 应用
  - 调试 Gateway（网关）发现或 Canvas 命令
---
# iOS App（iOS 应用）（节点）

可用性：内部预览。iOS 应用尚未公开发布。

## 它的作用

- 通过 WebSocket（LAN 或 tailnet）连接到 Gateway（网关）。
- 公开节点功能：Canvas、Screen snapshot（屏幕快照）、Camera capture（相机捕获）、Location（位置）、Talk mode（Talk 模式）、Voice wake（语音唤醒）。
- 接收 `node.invoke` 命令并报告节点状态事件。

## 要求

- Gateway（网关）在另一台设备上运行（macOS、Linux 或通过 WSL2 的 Windows）。
- 网络路径：
  - 通过 Bonjour 的同一 LAN，**或**
  - 通过 unicast DNS-SD 的 Tailnet（示例域：`openclaw.internal.`），**或**
  - 手动主机/端口（回退）。

## 快速入门（配对 + 连接）

1) 启动 Gateway（网关）：

```bash
openclaw gateway --port 18789
```

2) 在 iOS 应用中，打开 Settings（设置）并选择已发现的 Gateway（网关）（或启用 Manual Host（手动主机）并输入主机/端口）。

3) 在 Gateway（网关）主机上批准配对请求：

```bash
openclaw nodes pending
openclaw nodes approve <requestId>
```

4) 验证连接：

```bash
openclaw nodes status
openclaw gateway call node.list --params "{}"
```

## 发现路径

### Bonjour（LAN）

Gateway（网关）在 `local.` 上宣传 `_openclaw-gw._tcp`。iOS 应用会自动列出这些。

### Tailnet（跨网络）

如果 mDNS 被阻止，请使用 unicast DNS-SD 区域（选择一个域；示例：`openclaw.internal.`）和 Tailscale split DNS。
CoreDNS 示例请参阅 [Bonjour](/gateway/bonjour)。

### 手动主机/端口

在 Settings（设置）中，启用 **Manual Host（手动主机）** 并输入 Gateway（网关）主机 + 端口（默认 `18789`）。

## Canvas + A2UI

iOS 节点渲染 WKWebView Canvas。使用 `node.invoke` 驱动它：

```bash
openclaw nodes invoke --node "iOS Node" --command canvas.navigate --params '{"url":"http://<gateway-host>:18793/__openclaw__/canvas/"}'
```

注意事项：
- Gateway（网关）Canvas 主机提供 `/__openclaw__/canvas/` 和 `/__openclaw__/a2ui/`。
- 当 Canvas 主机 URL 被宣传时，iOS 节点在连接时自动导航到 A2UI。
- 使用 `canvas.navigate` 和 `{"url":""}` 返回到内置脚手架。

### Canvas eval / snapshot

```bash
openclaw nodes invoke --node "iOS Node" --command canvas.eval --params '{"javaScript":"(() => { const {ctx} = window.__openclaw; ctx.clearRect(0,0,innerWidth,innerHeight); ctx.lineWidth=6; ctx.strokeStyle=\"#ff2d55\"; ctx.beginPath(); ctx.moveTo(40,40); ctx.lineTo(innerWidth-40, innerHeight-40); ctx.stroke(); return \"ok\"; })()"}'
```

```bash
openclaw nodes invoke --node "iOS Node" --command canvas.snapshot --params '{"maxWidth":900,"format":"jpeg"}'
```

## Voice wake + talk mode（语音唤醒 + Talk 模式）

- Voice wake 和 Talk mode 在 Settings（设置）中可用。
- iOS 可能会暂停后台音频；将语音功能视为应用非活动时的尽力而为。

## 常见错误

- `NODE_BACKGROUND_UNAVAILABLE`：将 iOS 应用置于前台（canvas/camera/screen 命令需要它）。
- `A2UI_HOST_NOT_CONFIGURED`：Gateway（网关）未宣传 Canvas 主机 URL；检查 [Gateway configuration](/gateway/configuration) 中的 `canvasHost`。
- 配对提示从未出现：运行 `openclaw nodes pending` 并手动批准。
- 重新安装后重新连接失败：Keychain 配对令牌已清除；重新配对节点。

## 相关文档

- [Pairing](/gateway/pairing)
- [Discovery](/gateway/discovery)
- [Bonjour](/gateway/bonjour)
