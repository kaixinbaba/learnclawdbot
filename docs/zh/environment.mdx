---
summary: "OpenClaw 从哪里加载环境变量以及优先顺序"
read_when:
  - 你需要知道加载哪些环境变量，以及以什么顺序
  - 你正在调试 Gateway 中缺少的 API 密钥
  - 你正在记录提供商认证或部署环境
---
# Environment variables（环境变量）

OpenClaw 从多个来源拉取环境变量。规则是**永不覆盖现有值**。

## 优先级（从高到低）

1) **进程环境**（Gateway 进程已从父 shell/守护进程拥有的内容）。
2) **当前工作目录中的 `.env`**（dotenv 默认；不覆盖）。
3) **全局 `.env`**，位于 `~/.openclaw/.env`（即 `$OPENCLAW_STATE_DIR/.env`；不覆盖）。
4) **配置 `env` 块**，在 `~/.openclaw/openclaw.json` 中（仅在缺少时应用）。
5) **可选登录 shell 导入**（`env.shellEnv.enabled` 或 `OPENCLAW_LOAD_SHELL_ENV=1`），仅为缺少的预期键应用。

如果配置文件完全缺失，步骤 4 将被跳过；如果启用，shell 导入仍会运行。

## 配置 `env` 块

两种等效方式来设置内联环境变量（两者都不覆盖）：

```json5
{
  env: {
    OPENROUTER_API_KEY: "sk-or-...",
    vars: {
      GROQ_API_KEY: "gsk-..."
    }
  }
}
```

## Shell env 导入

`env.shellEnv` 运行你的登录 shell 并仅导入**缺少的**预期键：

```json5
{
  env: {
    shellEnv: {
      enabled: true,
      timeoutMs: 15000
    }
  }
}
```

环境变量等效项：
- `OPENCLAW_LOAD_SHELL_ENV=1`
- `OPENCLAW_SHELL_ENV_TIMEOUT_MS=15000`

## 配置中的环境变量替换

你可以使用 `${VAR_NAME}` 语法直接在配置字符串值中引用环境变量：

```json5
{
  models: {
    providers: {
      "vercel-gateway": {
        apiKey: "${VERCEL_GATEWAY_API_KEY}"
      }
    }
  }
}
```

查看 [Configuration: Env var substitution](/gateway/configuration#env-var-substitution-in-config) 了解完整详情。

## 相关

- [Gateway configuration](/gateway/configuration)
- [FAQ: env vars and .env loading](/help/faq#env-vars-and-env-loading)
- [Models overview](/concepts/models)
