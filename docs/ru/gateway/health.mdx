---
summary: "Шаги проверки здоровья для подключения каналов"
read_when:
  - Диагностика здоровья канала WhatsApp
---
# Проверки здоровья (CLI)

Краткое руководство по проверке подключения каналов без угадывания.

## Быстрые проверки
- `openclaw status` — локальная сводка: доступность gateway/режим, подсказка об обновлении, возраст аутентификации привязанного канала, сессии и последняя активность.
- `openclaw status --all` — полная локальная диагностика (только чтение, цветная, безопасно вставлять для отладки).
- `openclaw status --deep` — также проверяет запущенный Gateway (проверки для каждого канала, когда поддерживается).
- `openclaw health --json` — запрашивает у запущенного Gateway полный снимок здоровья (только WS; без прямого сокета Baileys).
- Отправьте `/status` как отдельное сообщение в WhatsApp/WebChat, чтобы получить ответ о статусе без вызова агента.
- Логи: выполните tail `/tmp/openclaw/openclaw-*.log` и фильтруйте по `web-heartbeat`, `web-reconnect`, `web-auto-reply`, `web-inbound`.

## Глубокая диагностика
- Учетные данные на диске: `ls -l ~/.openclaw/credentials/whatsapp/<accountId>/creds.json` (mtime должно быть недавним).
- Хранилище сессий: `ls -l ~/.openclaw/agents/<agentId>/sessions/sessions.json` (путь может быть переопределен в конфигурации). Количество и недавние получатели всплывают через `status`.
- Процесс переподключения: `openclaw channels logout && openclaw channels login --verbose`, когда в логах появляются коды статуса 409–515 или `loggedOut`. (Примечание: процесс входа по QR автоматически перезапускается один раз для статуса 515 после сопряжения.)

## Когда что-то не работает
- `logged out` или статус 409–515 → переподключитесь с `openclaw channels logout`, затем `openclaw channels login`.
- Gateway недоступен → запустите его: `openclaw gateway --port 18789` (используйте `--force`, если порт занят).
- Нет входящих сообщений → подтвердите, что привязанный телефон онлайн и отправитель разрешен (`channels.whatsapp.allowFrom`); для групповых чатов убедитесь, что список разрешенных и правила упоминаний совпадают (`channels.whatsapp.groups`, `agents.list[].groupChat.mentionPatterns`).

## Специализированная команда "health"
`openclaw health --json` запрашивает у запущенного Gateway его снимок здоровья (без прямых сокетов каналов из CLI). Он сообщает о привязанных учетных данных/возрасте аутентификации, когда доступно, сводки проверок для каждого канала, сводку хранилища сессий и длительность проверки. Завершается с ненулевым кодом, если Gateway недоступен или проверка не удалась/превысила таймаут. Используйте `--timeout <ms>`, чтобы переопределить таймаут по умолчанию 10 секунд.
