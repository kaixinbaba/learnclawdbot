---
summary: "Расширение Chrome: позвольте OpenClaw управлять вашей существующей вкладкой Chrome"
read_when:
  - Вы хотите, чтобы агент управлял существующей вкладкой Chrome (кнопка на панели инструментов)
  - Вам нужен удаленный Gateway + локальная автоматизация браузера через Tailscale
  - Вы хотите понять последствия захвата браузера для безопасности
---

# Расширение Chrome (релей браузера)

Расширение OpenClaw для Chrome позволяет агенту управлять вашими **существующими вкладками Chrome** (ваше обычное окно Chrome) вместо запуска отдельного профиля Chrome, управляемого openclaw.

Подключение/отключение происходит через **одну кнопку на панели инструментов Chrome**.

## Что это такое (концепция)

Есть три части:
- **Сервис управления браузером** (Gateway или узел): API, которое вызывает агент/инструмент (через Gateway)
- **Локальный релейный сервер** (loopback CDP): мост между сервером управления и расширением (`http://127.0.0.1:18792` по умолчанию)
- **Расширение Chrome MV3**: подключается к активной вкладке с помощью `chrome.debugger` и передает сообщения CDP релею

OpenClaw затем управляет подключенной вкладкой через обычную поверхность инструмента `browser` (выбирая правильный профиль).

## Установка / загрузка (распакованное)

1) Установите расширение по стабильному локальному пути:

```bash
openclaw browser extension install
```

2) Распечатайте путь к каталогу установленного расширения:

```bash
openclaw browser extension path
```

3) Chrome → `chrome://extensions`
- Включите "Режим разработчика"
- "Загрузить распакованное" → выберите каталог, распечатанный выше

4) Закрепите расширение.

## Обновления (нет шага сборки)

Расширение поставляется внутри релиза OpenClaw (пакет npm) как статические файлы. Нет отдельного шага "сборки".

После обновления OpenClaw:
- Повторно запустите `openclaw browser extension install`, чтобы обновить установленные файлы в вашем каталоге состояния OpenClaw.
- Chrome → `chrome://extensions` → нажмите "Перезагрузить" на расширении.

## Использование (без дополнительной настройки)

OpenClaw поставляется со встроенным профилем браузера с именем `chrome`, который нацелен на релей расширения на порту по умолчанию.

Используйте его:
- CLI: `openclaw browser --browser-profile chrome tabs`
- Инструмент агента: `browser` с `profile="chrome"`

Если вы хотите другое имя или другой релейный порт, создайте свой собственный профиль:

```bash
openclaw browser create-profile \
  --name my-chrome \
  --driver extension \
  --cdp-url http://127.0.0.1:18792 \
  --color "#00AA00"
```

## Подключение / отключение (кнопка на панели инструментов)

- Откройте вкладку, которой хотите управлять OpenClaw.
- Нажмите на иконку расширения.
  - Значок показывает `ON`, когда подключено.
- Нажмите снова, чтобы отключить.

## Какой вкладкой он управляет?

- Он **не** автоматически управляет "какой бы вкладкой вы ни смотрели".
- Он управляет **только теми вкладками, которые вы явно подключили**, нажав кнопку на панели инструментов.
- Чтобы переключиться: откройте другую вкладку и нажмите на иконку расширения там.

## Значок + распространенные ошибки

- `ON`: подключено; OpenClaw может управлять этой вкладкой.
- `…`: подключение к локальному релею.
- `!`: релей недоступен (чаще всего: релейный сервер браузера не работает на этой машине).

Если вы видите `!`:
- Убедитесь, что Gateway работает локально (настройка по умолчанию), или запустите узел-хост на этой машине, если Gateway работает в другом месте.
- Откройте страницу настроек расширения; она показывает, доступен ли релей.

## Удаленный Gateway (используйте узел-хост)

### Локальный Gateway (та же машина, что и Chrome) — обычно **никаких дополнительных шагов**

Если Gateway работает на той же машине, что и Chrome, он запускает сервис управления браузером на loopback и автоматически запускает релейный сервер. Расширение связывается с локальным релеем; вызовы CLI/инструмента идут к Gateway.

### Удаленный Gateway (Gateway работает в другом месте) — **запустите узел-хост**

Если ваш Gateway работает на другой машине, запустите узел-хост на машине, на которой работает Chrome. Gateway будет проксировать действия браузера на этот узел; расширение + релей остаются локальными для машины браузера.

Если подключено несколько узлов, закрепите один с помощью `gateway.nodes.browser.node` или установите `gateway.nodes.browser.mode`.

## Изолированная среда (контейнеры инструментов)

Если ваш сеанс агента находится в изолированной среде (`agents.defaults.sandbox.mode != "off"`), инструмент `browser` может быть ограничен:

- По умолчанию изолированные сеансы часто нацелены на **браузер изолированной среды** (`target="sandbox"`), а не на ваш Chrome хоста.
- Захват релея расширения Chrome требует управления сервером управления браузером **хоста**.

Варианты:
- Проще всего: используйте расширение из **неизолированного** сеанса/агента.
- Или разрешите управление браузером хоста для изолированных сеансов:

```json5
{
  agents: {
    defaults: {
      sandbox: {
        browser: {
          allowHostControl: true
        }
      }
    }
  }
}
```

Затем убедитесь, что инструмент не запрещен политикой инструментов, и (при необходимости) вызовите `browser` с `target="host"`.

Отладка: `openclaw sandbox explain`

## Советы по удаленному доступу

- Держите Gateway и узел-хост в одной сети tailnet; избегайте открытия релейных портов в LAN или публичный интернет.
- Сопрягайте узлы намеренно; отключите маршрутизацию прокси браузера, если вы не хотите удаленного управления (`gateway.nodes.browser.mode="off"`).

## Как работает "путь расширения"

`openclaw browser extension path` выводит **установленный** каталог на диске, содержащий файлы расширения.

CLI намеренно **не** выводит путь `node_modules`. Всегда сначала запускайте `openclaw browser extension install`, чтобы скопировать расширение в стабильное местоположение в вашем каталоге состояния OpenClaw.

Если вы переместите или удалите этот каталог установки, Chrome отметит расширение как сломанное, пока вы не перезагрузите его из действительного пути.

## Последствия для безопасности (прочтите это)

Это мощно и рискованно. Относитесь к этому как к предоставлению модели "рук на вашем браузере".

- Расширение использует API отладки Chrome (`chrome.debugger`). Когда подключено, модель может:
  - кликать/печатать/навигировать на этой вкладке
  - читать содержимое страницы
  - получать доступ к тому, к чему может получить доступ сеанс входа на вкладке
- **Это не изолировано**, как выделенный профиль, управляемый openclaw.
  - Если вы подключитесь к своему повседневному профилю/вкладке, вы предоставляете доступ к состоянию этого аккаунта.

Рекомендации:
- Предпочтительнее выделенный профиль Chrome (отдельный от вашего личного просмотра) для использования релея расширения.
- Держите Gateway и любые узлы-хосты только в tailnet; полагайтесь на аутентификацию Gateway + сопряжение узлов.
- Избегайте открытия релейных портов через LAN (`0.0.0.0`) и избегайте Funnel (публичный).

Связанное:
- Обзор инструмента браузера: [Браузер](/tools/browser)
- Аудит безопасности: [Безопасность](/gateway/security)
- Настройка Tailscale: [Tailscale](/gateway/tailscale)
