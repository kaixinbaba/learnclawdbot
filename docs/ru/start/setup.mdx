---
summary: "Руководство по настройке: поддерживайте настройку OpenClaw адаптированной, оставаясь в курсе обновлений"
read_when:
  - Настройка новой машины
  - Вы хотите "последнее + лучшее" без нарушения вашей личной настройки
---

# Настройка

Последнее обновление: 2026-01-01

## Кратко
- **Настройка живет вне репозитория:** `~/.openclaw/workspace` (рабочая область) + `~/.openclaw/openclaw.json` (конфигурация).
- **Стабильный рабочий процесс:** установите приложение macOS; пусть оно запускает встроенный Gateway.
- **Передовой рабочий процесс:** запускайте Gateway самостоятельно через `pnpm gateway:watch`, затем позвольте приложению macOS подключиться в локальном режиме.

## Предварительные требования (из исходного кода)
- Node `>=22`
- `pnpm`
- Docker (опционально; только для контейнерной настройки/e2e — см. [Docker](/install/docker))

## Стратегия настройки (чтобы обновления не повредили)

Если вы хотите "100% адаптированный под меня" *и* легкие обновления, держите свою настройку в:

- **Конфигурация:** `~/.openclaw/openclaw.json` (JSON/JSON5-подобный)
- **Рабочая область:** `~/.openclaw/workspace` (навыки, промпты, воспоминания; сделайте это приватным git репозиторием)

Начальная загрузка один раз:

```bash
openclaw setup
```

Из этого репозитория используйте локальную точку входа CLI:

```bash
openclaw setup
```

Если у вас еще нет глобальной установки, запустите через `pnpm openclaw setup`.

## Стабильный рабочий процесс (сначала приложение macOS)

1) Установите + запустите **OpenClaw.app** (строка меню).
2) Завершите контрольный список адаптации/разрешений (запросы TCC).
3) Убедитесь, что Gateway **Локальный** и работает (приложение управляет им).
4) Подключите поверхности (пример: WhatsApp):

```bash
openclaw channels login
```

5) Проверка работоспособности:

```bash
openclaw health
```

Если адаптация недоступна в вашей сборке:
- Запустите `openclaw setup`, затем `openclaw channels login`, затем запустите Gateway вручную (`openclaw gateway`).

## Передовой рабочий процесс (Gateway в терминале)

Цель: работать над TypeScript Gateway, получать горячую перезагрузку, сохранять интерфейс приложения macOS подключенным.

### 0) (Опционально) Запустите приложение macOS тоже из исходного кода

Если вы также хотите, чтобы приложение macOS было на переднем крае:

```bash
./scripts/restart-mac.sh
```

### 1) Запустите dev Gateway

```bash
pnpm install
pnpm gateway:watch
```

`gateway:watch` запускает gateway в режиме наблюдения и перезагружает при изменениях TypeScript.

### 2) Направьте приложение macOS на ваш запущенный Gateway

В **OpenClaw.app**:

- Режим подключения: **Локальный**
Приложение подключится к запущенному gateway на настроенном порту.

### 3) Проверка

- Статус Gateway в приложении должен показывать **"Using existing gateway …"**
- Или через CLI:

```bash
openclaw health
```

### Типичные ловушки
- **Неправильный порт:** Gateway WS по умолчанию `ws://127.0.0.1:18789`; держите приложение + CLI на одном порту.
- **Где живет состояние:**
  - Учетные данные: `~/.openclaw/credentials/`
  - Сессии: `~/.openclaw/agents/<agentId>/sessions/`
  - Логи: `/tmp/openclaw/`

## Карта хранения учетных данных

Используйте это при отладке аутентификации или принятии решения о резервном копировании:

- **WhatsApp**: `~/.openclaw/credentials/whatsapp/<accountId>/creds.json`
- **Токен бота Telegram**: config/env или `channels.telegram.tokenFile`
- **Токен бота Discord**: config/env (файл токена пока не поддерживается)
- **Токены Slack**: config/env (`channels.slack.*`)
- **Списки разрешенных сопряжения**: `~/.openclaw/credentials/<channel>-allowFrom.json`
- **Профили аутентификации модели**: `~/.openclaw/agents/<agentId>/agent/auth-profiles.json`
- **Импорт устаревшего OAuth**: `~/.openclaw/credentials/oauth.json`
Подробнее: [Security](/gateway/security#credential-storage-map).

## Обновление (без разрушения вашей настройки)

- Держите `~/.openclaw/workspace` и `~/.openclaw/` как "ваши вещи"; не помещайте личные промпты/конфигурацию в репозиторий `openclaw`.
- Обновление исходного кода: `git pull` + `pnpm install` (когда lockfile изменился) + продолжайте использовать `pnpm gateway:watch`.

## Linux (пользовательский сервис systemd)

Установки Linux используют **пользовательский** сервис systemd. По умолчанию systemd останавливает пользовательские сервисы при выходе/простое, что убивает Gateway. Адаптация пытается включить lingering для вас (может запросить sudo). Если он все еще выключен, запустите:

```bash
sudo loginctl enable-linger $USER
```

Для постоянно работающих или многопользовательских серверов рассмотрите **системный** сервис вместо пользовательского (lingering не требуется). См. [Gateway runbook](/gateway) для заметок о systemd.

## Связанная документация

- [Gateway runbook](/gateway) (флаги, надзор, порты)
- [Конфигурация Gateway](/gateway/configuration) (схема конфигурации + примеры)
- [Discord](/channels/discord) и [Telegram](/channels/telegram) (теги ответа + настройки replyToMode)
- [Настройка помощника OpenClaw](/start/openclaw)
- [Приложение macOS](/platforms/macos) (жизненный цикл gateway)
