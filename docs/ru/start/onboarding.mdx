---
summary: "Процесс первого запуска настройки для OpenClaw (приложение macOS)"
read_when:
  - Проектирование ассистента настройки macOS
  - Реализация настройки аутентификации или идентичности
---
# Настройка (приложение macOS)

Этот документ описывает **текущий** процесс настройки первого запуска. Цель — плавный опыт "нулевого дня": выбрать, где запускается Gateway, подключить аутентификацию, запустить мастер и позволить агенту самостоятельно загрузиться.

## Порядок страниц (текущий)

1) Приветствие + уведомление о безопасности
2) **Выбор Gateway** (Локальный / Удаленный / Настроить позже)
3) **Аутентификация (Anthropic OAuth)** — только локальный
4) **Мастер настройки** (управляемый Gateway)
5) **Разрешения** (запросы TCC)
6) **CLI** (опционально)
7) **Чат настройки** (выделенная сессия)
8) Готово

## 1) Локальный vs Удаленный

Где запускается **Gateway**?

- **Локальный (этот Mac):** настройка может запускать процессы OAuth и записывать учетные данные локально.
- **Удаленный (через SSH/Tailnet):** настройка **не** запускает OAuth локально; учетные данные должны существовать на хосте gateway.
- **Настроить позже:** пропустить настройку и оставить приложение ненастроенным.

Совет по аутентификации Gateway:
- Мастер теперь генерирует **токен** даже для loopback, поэтому локальные WS-клиенты должны аутентифицироваться.
- Если вы отключите аутентификацию, любой локальный процесс может подключиться; используйте это только на полностью доверенных машинах.
- Используйте **токен** для многомашинного доступа или привязок не-loopback.

## 2) Локальная аутентификация (Anthropic OAuth)

Приложение macOS поддерживает Anthropic OAuth (Claude Pro/Max). Процесс:

- Открывает браузер для OAuth (PKCE)
- Просит пользователя вставить значение `code#state`
- Записывает учетные данные в `~/.openclaw/credentials/oauth.json`

Другие провайдеры (OpenAI, пользовательские API) настраиваются через переменные окружения или конфигурационные файлы на данный момент.

## 3) Мастер настройки (управляемый Gateway)

Приложение может запустить тот же мастер настройки, что и CLI. Это держит настройку в синхронизации с поведением со стороны Gateway и избегает дублирования логики в SwiftUI.

## 4) Разрешения

Настройка запрашивает разрешения TCC, необходимые для:

- Уведомлений
- Доступности
- Записи экрана
- Микрофона / Распознавания речи
- Автоматизации (AppleScript)

## 5) CLI (опционально)

Приложение может установить глобальный CLI `openclaw` через npm/pnpm, чтобы терминальные рабочие процессы и задачи launchd работали из коробки.

## 6) Чат настройки (выделенная сессия)

После настройки приложение открывает выделенную сессию чата настройки, чтобы агент мог представиться и направить следующие шаги. Это держит руководство первого запуска отдельно от вашего обычного разговора.

## Ритуал загрузки агента

При первом запуске агента OpenClaw загружает рабочее пространство (по умолчанию `~/.openclaw/workspace`):

- Создает `AGENTS.md`, `BOOTSTRAP.md`, `IDENTITY.md`, `USER.md`
- Запускает короткий ритуал вопросов и ответов (по одному вопросу за раз)
- Записывает идентичность + предпочтения в `IDENTITY.md`, `USER.md`, `SOUL.md`
- Удаляет `BOOTSTRAP.md` после завершения, чтобы он запускался только один раз

## Опционально: хуки Gmail (вручную)

Настройка Gmail Pub/Sub в настоящее время является ручным шагом. Используйте:

```bash
openclaw webhooks gmail setup --account you@gmail.com
```

См. [/automation/gmail-pubsub](/automation/gmail-pubsub) для деталей.

## Заметки по удаленному режиму

Когда Gateway работает на другой машине, учетные данные и файлы рабочего пространства живут **на этом хосте**. Если вам нужен OAuth в удаленном режиме, создайте:

- `~/.openclaw/credentials/oauth.json`
- `~/.openclaw/agents/<agentId>/agent/auth-profiles.json`

на хосте gateway.
